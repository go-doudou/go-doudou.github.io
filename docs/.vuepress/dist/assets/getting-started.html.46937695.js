import{r as p,o as c,a as i,b as s,e as a,w as r,F as t,f as l,g as n}from"./app.04f9bf74.js";import{_ as D,a as u}from"./greeting1.b58367d5.js";import{_ as d}from"./plugin-vue_export-helper.21dcd24c.js";const b={},m=l(`<h1 id="getting-started" tabindex="-1"><a class="header-anchor" href="#getting-started" aria-hidden="true">#</a> Getting Started</h1><h2 id="prerequisites" tabindex="-1"><a class="header-anchor" href="#prerequisites" aria-hidden="true">#</a> Prerequisites</h2><ul><li>go 1.13, 1.14, 1.15 with GO111MODULE=on</li><li>go 1.16+</li><li>&lt; go 1.13: not test, maybe support</li></ul><h2 id="install" tabindex="-1"><a class="header-anchor" href="#install" aria-hidden="true">#</a> Install</h2><ul><li>If go version &lt; 1.17,</li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">go get -v github.com/unionj-cloud/go-doudou@v1.0.3</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><ul><li>If go version &gt;= 1.17, recommend to use below command to install go-doudou cli globally</li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">go install -v github.com/unionj-cloud/go-doudou@v1.0.3</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>and use below command to download go-doudou as dependency for your module.</p><div class="language-bash ext-sh line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">go get -v -d github.com/unionj-cloud/go-doudou@v1.0.3</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>If you meet 410 Gone error, try to run below command, then run install command again:</p><div class="language-bash ext-sh line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#569CD6;">export</span><span style="color:#D4D4D4;"> GOSUMDB=off</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div></div><h2 id="upgrade" tabindex="-1"><a class="header-anchor" href="#upgrade" aria-hidden="true">#</a> Upgrade</h2><p>You can run <code>go-doudou version</code> to upgrade cli.</p><div class="language-bash ext-sh line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">\u279C  ~ go-doudou version                       </span></span>
<span class="line"><span style="color:#D4D4D4;">Installed version is v0.9.8</span></span>
<span class="line"><span style="color:#D4D4D4;">Latest release version is v1.0.3</span></span>
<span class="line"><span style="color:#D4D4D4;">\u2714 Yes</span></span>
<span class="line"><span style="color:#D4D4D4;">go install -v github.com/unionj-cloud/go-doudou@v1.0.3</span></span>
<span class="line"><span style="color:#D4D4D4;">go: downloading github.com/unionj-cloud/go-doudou v1.0.3</span></span>
<span class="line"><span style="color:#D4D4D4;">github.com/unionj-cloud/go-doudou/toolkit/sqlext/columnenum</span></span>
<span class="line"><span style="color:#D4D4D4;">github.com/unionj-cloud/go-doudou/toolkit/sqlext/sortenum</span></span>
<span class="line"><span style="color:#D4D4D4;">github.com/unionj-cloud/go-doudou/toolkit/sqlext/nullenum</span></span>
<span class="line"><span style="color:#D4D4D4;">github.com/unionj-cloud/go-doudou/toolkit/sqlext/keyenum</span></span>
<span class="line"><span style="color:#D4D4D4;">github.com/unionj-cloud/go-doudou/toolkit/sqlext/extraenum</span></span>
<span class="line"><span style="color:#D4D4D4;">github.com/unionj-cloud/go-doudou/toolkit/sqlext/config</span></span>
<span class="line"><span style="color:#D4D4D4;">github.com/unionj-cloud/go-doudou/toolkit/constants</span></span>
<span class="line"><span style="color:#D4D4D4;">github.com/unionj-cloud/go-doudou/toolkit/stringutils</span></span>
<span class="line"><span style="color:#D4D4D4;">github.com/unionj-cloud/go-doudou/toolkit/sliceutils</span></span>
<span class="line"><span style="color:#D4D4D4;">github.com/unionj-cloud/go-doudou/toolkit/templateutils</span></span>
<span class="line"><span style="color:#D4D4D4;">github.com/unionj-cloud/go-doudou/toolkit/sqlext/wrapper</span></span>
<span class="line"><span style="color:#D4D4D4;">github.com/unionj-cloud/go-doudou/toolkit/pathutils</span></span>
<span class="line"><span style="color:#D4D4D4;">github.com/unionj-cloud/go-doudou/framework/internal/config</span></span>
<span class="line"><span style="color:#D4D4D4;">github.com/unionj-cloud/go-doudou/copier</span></span>
<span class="line"><span style="color:#D4D4D4;">github.com/unionj-cloud/go-doudou/executils</span></span>
<span class="line"><span style="color:#D4D4D4;">github.com/unionj-cloud/go-doudou/cmd/internal/astutils</span></span>
<span class="line"><span style="color:#D4D4D4;">github.com/unionj-cloud/go-doudou/logutils</span></span>
<span class="line"><span style="color:#D4D4D4;">github.com/unionj-cloud/go-doudou/test</span></span>
<span class="line"><span style="color:#D4D4D4;">github.com/unionj-cloud/go-doudou/name</span></span>
<span class="line"><span style="color:#D4D4D4;">github.com/unionj-cloud/go-doudou/toolkit/sqlext/ddlast</span></span>
<span class="line"><span style="color:#D4D4D4;">github.com/unionj-cloud/go-doudou/openapi/v3</span></span>
<span class="line"><span style="color:#D4D4D4;">github.com/unionj-cloud/go-doudou/toolkit/sqlext/table</span></span>
<span class="line"><span style="color:#D4D4D4;">github.com/unionj-cloud/go-doudou/openapi/v3/codegen/client</span></span>
<span class="line"><span style="color:#D4D4D4;">github.com/unionj-cloud/go-doudou/framework/internal/codegen</span></span>
<span class="line"><span style="color:#D4D4D4;">github.com/unionj-cloud/go-doudou/toolkit/sqlext/codegen</span></span>
<span class="line"><span style="color:#D4D4D4;">github.com/unionj-cloud/go-doudou/ddl</span></span>
<span class="line"><span style="color:#D4D4D4;">github.com/unionj-cloud/go-doudou/svc</span></span>
<span class="line"><span style="color:#D4D4D4;">github.com/unionj-cloud/go-doudou/cmd</span></span>
<span class="line"><span style="color:#D4D4D4;">github.com/unionj-cloud/go-doudou</span></span>
<span class="line"><span style="color:#D4D4D4;">DONE</span></span>
<span class="line"><span style="color:#D4D4D4;">\u279C  ~ go-doudou version</span></span>
<span class="line"><span style="color:#D4D4D4;">Installed version is v1.0.3</span></span>
<span class="line"><span style="color:#D4D4D4;">\u279C  ~ </span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br></div></div><h2 id="usage" tabindex="-1"><a class="header-anchor" href="#usage" aria-hidden="true">#</a> Usage</h2><div class="language-bash ext-sh line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">\u279C  ~ go-doudou -h                            </span></span>
<span class="line"><span style="color:#D4D4D4;">go-doudou works like a scaffolding tool but more than that. </span></span>
<span class="line"><span style="color:#D4D4D4;">it lets api providers design their apis and </span><span style="color:#DCDCAA;">help</span><span style="color:#D4D4D4;"> them code less. </span></span>
<span class="line"><span style="color:#D4D4D4;">it generates openapi 3.0 spec json document </span><span style="color:#C586C0;">for</span><span style="color:#D4D4D4;"> frontend developers or other api consumers to understand what apis there, </span></span>
<span class="line"><span style="color:#D4D4D4;">consumers can import it into postman to debug and test, or upload it into some code generators to download client sdk.</span></span>
<span class="line"><span style="color:#D4D4D4;">it provides some useful components and middleware </span><span style="color:#C586C0;">for</span><span style="color:#D4D4D4;"> constructing microservice cluster like service register and discovering, </span></span>
<span class="line"><span style="color:#D4D4D4;">load balancing and so on. it just begins, more features will come out soon.</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D4D4D4;">Usage:</span></span>
<span class="line"><span style="color:#D4D4D4;">  go-doudou [flags]</span></span>
<span class="line"><span style="color:#D4D4D4;">  go-doudou [command]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D4D4D4;">Available Commands:</span></span>
<span class="line"><span style="color:#D4D4D4;">  ddl         migration tool between database table structure and golang struct</span></span>
<span class="line"><span style="color:#D4D4D4;">  </span><span style="color:#DCDCAA;">help</span><span style="color:#D4D4D4;">        Help about any </span><span style="color:#DCDCAA;">command</span></span>
<span class="line"><span style="color:#D4D4D4;">  name        bulk add or update struct fields json tag</span></span>
<span class="line"><span style="color:#D4D4D4;">  svc         generate or update service</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D4D4D4;">Flags:</span></span>
<span class="line"><span style="color:#D4D4D4;">  -h, --help      </span><span style="color:#DCDCAA;">help</span><span style="color:#D4D4D4;"> </span><span style="color:#C586C0;">for</span><span style="color:#D4D4D4;"> go-doudou</span></span>
<span class="line"><span style="color:#D4D4D4;">  -v, --version   version </span><span style="color:#C586C0;">for</span><span style="color:#D4D4D4;"> go-doudou</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D4D4D4;">Use </span><span style="color:#CE9178;">&quot;go-doudou [command] --help&quot;</span><span style="color:#D4D4D4;"> </span><span style="color:#C586C0;">for</span><span style="color:#D4D4D4;"> more information about a command.  </span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><h2 id="hello-world" tabindex="-1"><a class="header-anchor" href="#hello-world" aria-hidden="true">#</a> Hello World</h2><h3 id="initialize-project" tabindex="-1"><a class="header-anchor" href="#initialize-project" aria-hidden="true">#</a> Initialize Project</h3><p>Run <code>svc init</code> command, you can use <code>-m</code> flag to specify module name.</p><div class="language-bash ext-sh line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">go-doudou svc init helloworld -m github.com/unionj-cloud/helloworld</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>It creates helloworld folder and some initial files.</p><div class="language-text ext-text line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">\u279C  helloworld git:(master) \u2717 tree -a 
.
\u251C\u2500\u2500 .env
\u251C\u2500\u2500 .git
\u2502\xA0\xA0 \u251C\u2500\u2500 HEAD
\u2502\xA0\xA0 \u251C\u2500\u2500 objects
\u2502\xA0\xA0 \u2502\xA0\xA0 \u251C\u2500\u2500 info
\u2502\xA0\xA0 \u2502\xA0\xA0 \u2514\u2500\u2500 pack
\u2502\xA0\xA0 \u2514\u2500\u2500 refs
\u2502\xA0\xA0     \u251C\u2500\u2500 heads
\u2502\xA0\xA0     \u2514\u2500\u2500 tags
\u251C\u2500\u2500 .gitignore
\u251C\u2500\u2500 Dockerfile
\u251C\u2500\u2500 go.mod
\u251C\u2500\u2500 svc.go
\u2514\u2500\u2500 vo
    \u2514\u2500\u2500 vo.go

8 directories, 7 files
</span></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><ul><li><p>Dockerfile\uFF1Abuild docker image</p></li><li><p>svc.go: design your RESTful apis by defining methods in <code>Helloworld</code> interface</p></li><li><p>vo folder\uFF1Adefine structs as view objects and OpenAPI 3.0 schemas used in http request body and response body</p></li><li><p>.env: config file used to load <code>GDD_</code> prefixed environment variables</p></li></ul><h3 id="define-api" tabindex="-1"><a class="header-anchor" href="#define-api" aria-hidden="true">#</a> Define API</h3>`,24),y=s("code",null,"svc.go",-1),g=n(" file is the idl file to describe your apis. Let's comment out the example api "),h=s("code",null,"PageUsers",-1),f=n(" and define our own like "),v=s("code",null,"Greeting",-1),_=n("."),C=s("br",null,null,-1),E=n(" Please refer to "),k=n("Define API"),w=n(" to learn more."),x=l(`<div class="language-go ext-go line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#569CD6;">package</span><span style="color:#D4D4D4;"> service</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">import</span><span style="color:#D4D4D4;"> (</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#CE9178;">&quot;context&quot;</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#CE9178;">&quot;helloworld/vo&quot;</span></span>
<span class="line"><span style="color:#D4D4D4;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">type</span><span style="color:#D4D4D4;"> </span><span style="color:#4EC9B0;">Helloworld</span><span style="color:#D4D4D4;"> </span><span style="color:#569CD6;">interface</span><span style="color:#D4D4D4;"> {</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#6A9955;">// You can define your service methods as your need. Below is an example.</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#6A9955;">// PageUsers(ctx context.Context, query vo.PageQuery) (code int, data vo.PageRet, err error)</span></span>
<span class="line"><span style="color:#D4D4D4;">  </span><span style="color:#DCDCAA;">Greeting</span><span style="color:#D4D4D4;">(ctx context.Context, greeting </span><span style="color:#4EC9B0;">string</span><span style="color:#D4D4D4;">) (data </span><span style="color:#4EC9B0;">string</span><span style="color:#D4D4D4;">, err </span><span style="color:#4EC9B0;">error</span><span style="color:#D4D4D4;">)</span></span>
<span class="line"><span style="color:#D4D4D4;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h3 id="generate-code" tabindex="-1"><a class="header-anchor" href="#generate-code" aria-hidden="true">#</a> Generate Code</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">go-doudou svc http --handler -c --doc</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>then we should run <code>go mod tidy</code> to download dependencies. If you use go 1.17, you will see below instruction:</p><div class="language-text ext-text line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">To upgrade to the versions selected by go 1.16:
	go mod tidy -go=1.16 &amp;&amp; go mod tidy -go=1.17
If reproducibility with go 1.16 is not needed:
	go mod tidy -compat=1.17
For other options, see:
	https://golang.org/doc/modules/pruning
</span></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>Then you should run <code>go mod tidy -go=1.16 &amp;&amp; go mod tidy -go=1.17</code> or <code>go mod tidy -compat=1.17</code>.<br> Let&#39;s see what are generated.</p><div class="language-bash ext-sh line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#DCDCAA;">.</span></span>
<span class="line"><span style="color:#D4D4D4;">\u251C\u2500\u2500 Dockerfile</span></span>
<span class="line"><span style="color:#D4D4D4;">\u251C\u2500\u2500 client</span></span>
<span class="line"><span style="color:#D4D4D4;">\u2502\xA0\xA0 \u251C\u2500\u2500 client.go</span></span>
<span class="line"><span style="color:#D4D4D4;">\u2502\xA0\xA0 \u251C\u2500\u2500 clientproxy.go</span></span>
<span class="line"><span style="color:#D4D4D4;">\u2502\xA0\xA0 \u2514\u2500\u2500 iclient.go</span></span>
<span class="line"><span style="color:#D4D4D4;">\u251C\u2500\u2500 cmd</span></span>
<span class="line"><span style="color:#D4D4D4;">\u2502\xA0\xA0 \u2514\u2500\u2500 main.go</span></span>
<span class="line"><span style="color:#D4D4D4;">\u251C\u2500\u2500 config</span></span>
<span class="line"><span style="color:#D4D4D4;">\u2502\xA0\xA0 \u2514\u2500\u2500 config.go</span></span>
<span class="line"><span style="color:#D4D4D4;">\u251C\u2500\u2500 db</span></span>
<span class="line"><span style="color:#D4D4D4;">\u2502\xA0\xA0 \u2514\u2500\u2500 db.go</span></span>
<span class="line"><span style="color:#D4D4D4;">\u251C\u2500\u2500 go.mod</span></span>
<span class="line"><span style="color:#D4D4D4;">\u251C\u2500\u2500 go.sum</span></span>
<span class="line"><span style="color:#D4D4D4;">\u251C\u2500\u2500 helloworld_openapi3.go</span></span>
<span class="line"><span style="color:#D4D4D4;">\u251C\u2500\u2500 helloworld_openapi3.json</span></span>
<span class="line"><span style="color:#D4D4D4;">\u251C\u2500\u2500 svc.go</span></span>
<span class="line"><span style="color:#D4D4D4;">\u251C\u2500\u2500 svcimpl.go</span></span>
<span class="line"><span style="color:#D4D4D4;">\u251C\u2500\u2500 transport</span></span>
<span class="line"><span style="color:#D4D4D4;">\u2502\xA0\xA0 \u2514\u2500\u2500 httpsrv</span></span>
<span class="line"><span style="color:#D4D4D4;">\u2502\xA0\xA0     \u251C\u2500\u2500 handler.go</span></span>
<span class="line"><span style="color:#D4D4D4;">\u2502\xA0\xA0     \u251C\u2500\u2500 handlerimpl.go</span></span>
<span class="line"><span style="color:#D4D4D4;">\u2502\xA0\xA0     \u2514\u2500\u2500 middleware.go</span></span>
<span class="line"><span style="color:#D4D4D4;">\u2514\u2500\u2500 vo</span></span>
<span class="line"><span style="color:#D4D4D4;">    \u2514\u2500\u2500 vo.go</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div>`,7),A=s("li",null,"helloworld_openapi3.json: OpenAPI 3.0 spec json documentation",-1),j=s("li",null,"helloworld_openapi3.go: assign OpenAPI 3.0 spec json string to a variable for serving online",-1),I=n("client folder: golang http client sdk based on "),q={href:"https://github.com/go-resty/resty",target:"_blank",rel:"noopener noreferrer"},B=n("resty"),N=s("li",null,"cmd folder: entry of the whole program",-1),O=s("li",null,"config folder: used for loading your custom business related configs",-1),P=s("li",null,"db folder: helper function for connecting to database",-1),F=s("li",null,"svcimpl.go: code your business logic here",-1),R=s("li",null,"transport folder: http routes and handlers",-1),T=l(`<h3 id="run" tabindex="-1"><a class="header-anchor" href="#run" aria-hidden="true">#</a> Run</h3><p>Run <code>go-doudou svc run</code></p><div class="language-bash ext-sh line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">\u279C  helloworld git:(master) \u2717 go-doudou svc run       </span></span>
<span class="line"><span style="color:#D4D4D4;"> _____                     _                    _</span></span>
<span class="line"><span style="color:#D4D4D4;">|  __ </span><span style="color:#D7BA7D;">\\ </span><span style="color:#D4D4D4;">                  | |                  | |</span></span>
<span class="line"><span style="color:#D4D4D4;">| |  </span><span style="color:#D7BA7D;">\\/</span><span style="color:#D4D4D4;">  ___   ______   __| |  ___   _   _   __| |  ___   _   _</span></span>
<span class="line"><span style="color:#D4D4D4;">| | __  / _ </span><span style="color:#D7BA7D;">\\ </span><span style="color:#D4D4D4;">|______| / _</span><span style="color:#CE9178;">\` </span><span style="color:#D4D4D4;">|</span><span style="color:#CE9178;"> / _ </span><span style="color:#D7BA7D;">\\ </span><span style="color:#D4D4D4;">|</span><span style="color:#CE9178;"> </span><span style="color:#D4D4D4;">|</span><span style="color:#CE9178;"> </span><span style="color:#D4D4D4;">|</span><span style="color:#CE9178;"> </span><span style="color:#D4D4D4;">|</span><span style="color:#CE9178;"> / _\`</span><span style="color:#D4D4D4;"> | / _ </span><span style="color:#D7BA7D;">\\ </span><span style="color:#D4D4D4;">| | | |</span></span>
<span class="line"><span style="color:#D4D4D4;">| |_</span><span style="color:#D7BA7D;">\\ \\|</span><span style="color:#D4D4D4;"> (_) |        | (_| || (_) || |_| || (_| || (_) || |_| |</span></span>
<span class="line"><span style="color:#D4D4D4;"> </span><span style="color:#D7BA7D;">\\_</span><span style="color:#D4D4D4;">___/ </span><span style="color:#D7BA7D;">\\_</span><span style="color:#D4D4D4;">__/          </span><span style="color:#D7BA7D;">\\_</span><span style="color:#D4D4D4;">_,_| </span><span style="color:#D7BA7D;">\\_</span><span style="color:#D4D4D4;">__/  </span><span style="color:#D7BA7D;">\\_</span><span style="color:#D4D4D4;">_,_| </span><span style="color:#D7BA7D;">\\_</span><span style="color:#D4D4D4;">_,_| </span><span style="color:#D7BA7D;">\\_</span><span style="color:#D4D4D4;">__/  </span><span style="color:#D7BA7D;">\\_</span><span style="color:#D4D4D4;">_,_|</span></span>
<span class="line"><span style="color:#D4D4D4;">INFO[2022-02-13 22:14:15] ================ Registered Routes ================ </span></span>
<span class="line"><span style="color:#D4D4D4;">INFO[2022-02-13 22:14:15] +-------------+--------+-------------------------+ </span></span>
<span class="line"><span style="color:#D4D4D4;">INFO[2022-02-13 22:14:15] |    NAME     | METHOD |         PATTERN         | </span></span>
<span class="line"><span style="color:#D4D4D4;">INFO[2022-02-13 22:14:15] +-------------+--------+-------------------------+ </span></span>
<span class="line"><span style="color:#D4D4D4;">INFO[2022-02-13 22:14:15] | Greeting    | POST   | /greeting               | </span></span>
<span class="line"><span style="color:#D4D4D4;">INFO[2022-02-13 22:14:15] | GetDoc      | GET    | /go-doudou/doc          | </span></span>
<span class="line"><span style="color:#D4D4D4;">INFO[2022-02-13 22:14:15] | GetOpenAPI  | GET    | /go-doudou/openapi.json | </span></span>
<span class="line"><span style="color:#D4D4D4;">INFO[2022-02-13 22:14:15] | Prometheus  | GET    | /go-doudou/prometheus   | </span></span>
<span class="line"><span style="color:#D4D4D4;">INFO[2022-02-13 22:14:15] | GetRegistry | GET    | /go-doudou/registry     | </span></span>
<span class="line"><span style="color:#D4D4D4;">INFO[2022-02-13 22:14:15] | GetConfig   | GET    | /go-doudou/config       | </span></span>
<span class="line"><span style="color:#D4D4D4;">INFO[2022-02-13 22:14:15] +-------------+--------+-------------------------+ </span></span>
<span class="line"><span style="color:#D4D4D4;">INFO[2022-02-13 22:14:15] =================================================== </span></span>
<span class="line"><span style="color:#D4D4D4;">INFO[2022-02-13 22:14:15] Started </span><span style="color:#C586C0;">in</span><span style="color:#D4D4D4;"> 468.771\xB5s                         </span></span>
<span class="line"><span style="color:#D4D4D4;">INFO[2022-02-13 22:14:15] Http server is listening on :6060 </span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h3 id="postman" tabindex="-1"><a class="header-anchor" href="#postman" aria-hidden="true">#</a> Postman</h3><p>Import helloworld_openapi3.json to postman to test <code>/greeting</code> api. You can see fake response returned. <img src="`+D+`" alt="greeting"></p><h3 id="implementation" tabindex="-1"><a class="header-anchor" href="#implementation" aria-hidden="true">#</a> Implementation</h3><p>Now we are going to start implementing our business logic in <code>svcimpl.go</code> file. Let&#39;s what code already there.</p><div class="language-go ext-go line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#569CD6;">package</span><span style="color:#D4D4D4;"> service</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">import</span><span style="color:#D4D4D4;"> (</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#CE9178;">&quot;context&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#CE9178;">&quot;github.com/brianvoe/gofakeit/v6&quot;</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#CE9178;">&quot;github.com/unionj-cloud/helloworld/config&quot;</span></span>
<span class="line"><span style="color:#D4D4D4;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">type</span><span style="color:#D4D4D4;"> </span><span style="color:#4EC9B0;">HelloworldImpl</span><span style="color:#D4D4D4;"> </span><span style="color:#569CD6;">struct</span><span style="color:#D4D4D4;"> {</span></span>
<span class="line"><span style="color:#D4D4D4;">	conf *config.Config</span></span>
<span class="line"><span style="color:#D4D4D4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">func</span><span style="color:#D4D4D4;"> (receiver *HelloworldImpl) </span><span style="color:#DCDCAA;">Greeting</span><span style="color:#D4D4D4;">(ctx context.Context, greeting </span><span style="color:#4EC9B0;">string</span><span style="color:#D4D4D4;">) (data </span><span style="color:#4EC9B0;">string</span><span style="color:#D4D4D4;">, err </span><span style="color:#4EC9B0;">error</span><span style="color:#D4D4D4;">) {</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#569CD6;">var</span><span style="color:#D4D4D4;"> </span><span style="color:#9CDCFE;">_result</span><span style="color:#D4D4D4;"> </span><span style="color:#569CD6;">struct</span><span style="color:#D4D4D4;"> {</span></span>
<span class="line"><span style="color:#D4D4D4;">		Data </span><span style="color:#4EC9B0;">string</span></span>
<span class="line"><span style="color:#D4D4D4;">	}</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#9CDCFE;">_</span><span style="color:#D4D4D4;"> = gofakeit.</span><span style="color:#DCDCAA;">Struct</span><span style="color:#D4D4D4;">(&amp;_result)</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#C586C0;">return</span><span style="color:#D4D4D4;"> _result.Data, </span><span style="color:#569CD6;">nil</span></span>
<span class="line"><span style="color:#D4D4D4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">func</span><span style="color:#D4D4D4;"> </span><span style="color:#DCDCAA;">NewHelloworld</span><span style="color:#D4D4D4;">(conf *config.Config) Helloworld {</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#C586C0;">return</span><span style="color:#D4D4D4;"> &amp;HelloworldImpl{</span></span>
<span class="line"><span style="color:#D4D4D4;">		conf,</span></span>
<span class="line"><span style="color:#D4D4D4;">	}</span></span>
<span class="line"><span style="color:#D4D4D4;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><p>We use <a href="github.com/brianvoe/gofakeit">gofakeit</a> to generate fake response as default implementation. Now we should get rid of it and start to code.</p><div class="language-go ext-go line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#569CD6;">package</span><span style="color:#D4D4D4;"> service</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">import</span><span style="color:#D4D4D4;"> (</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#CE9178;">&quot;context&quot;</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#CE9178;">&quot;fmt&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#CE9178;">&quot;github.com/unionj-cloud/helloworld/config&quot;</span></span>
<span class="line"><span style="color:#D4D4D4;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">type</span><span style="color:#D4D4D4;"> </span><span style="color:#4EC9B0;">HelloworldImpl</span><span style="color:#D4D4D4;"> </span><span style="color:#569CD6;">struct</span><span style="color:#D4D4D4;"> {</span></span>
<span class="line"><span style="color:#D4D4D4;">	conf *config.Config</span></span>
<span class="line"><span style="color:#D4D4D4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">func</span><span style="color:#D4D4D4;"> (receiver *HelloworldImpl) </span><span style="color:#DCDCAA;">Greeting</span><span style="color:#D4D4D4;">(ctx context.Context, greeting </span><span style="color:#4EC9B0;">string</span><span style="color:#D4D4D4;">) (data </span><span style="color:#4EC9B0;">string</span><span style="color:#D4D4D4;">, err </span><span style="color:#4EC9B0;">error</span><span style="color:#D4D4D4;">) {</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#C586C0;">return</span><span style="color:#D4D4D4;"> fmt.</span><span style="color:#DCDCAA;">Sprintf</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&quot;Hello </span><span style="color:#9CDCFE;">%s</span><span style="color:#CE9178;">&quot;</span><span style="color:#D4D4D4;">, greeting), </span><span style="color:#569CD6;">nil</span></span>
<span class="line"><span style="color:#D4D4D4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">func</span><span style="color:#D4D4D4;"> </span><span style="color:#DCDCAA;">NewHelloworld</span><span style="color:#D4D4D4;">(conf *config.Config) Helloworld {</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#C586C0;">return</span><span style="color:#D4D4D4;"> &amp;HelloworldImpl{</span></span>
<span class="line"><span style="color:#D4D4D4;">		conf,</span></span>
<span class="line"><span style="color:#D4D4D4;">	}</span></span>
<span class="line"><span style="color:#D4D4D4;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>We removed Line 15~19 and replaced with <code>return fmt.Sprintf(&quot;Hello %s&quot;, greeting), nil</code>. Then let&#39;s test it again. <img src="`+u+'" alt="greeting1"> You see, it&#39;s really very simple to write a RESTful service with go-doudou!</p><h3 id="deployment" tabindex="-1"><a class="header-anchor" href="#deployment" aria-hidden="true">#</a> Deployment</h3>',12),G=n("There are a lot of approaches to deploy go http server. We'd like to use kubernetes to deploy our projects. Please refer to "),H=n("Deployment"),S=n(" to learn more."),M=l(`<h4 id="build-docker-image" tabindex="-1"><a class="header-anchor" href="#build-docker-image" aria-hidden="true">#</a> Build Docker Image</h4><p>Run <code>go-doudou svc push -r wubin1989</code>, don&#39;t forget change <code>wubin1989</code> to your remote docker image reposiotry.</p><div class="language-bash ext-sh line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">\u279C  helloworld git:(master) \u2717 go-doudou svc push -r wubin1989</span></span>
<span class="line"><span style="color:#D4D4D4;">[+] Building 42.9s (13/13) FINISHED                                                                                                                                </span></span>
<span class="line"><span style="color:#D4D4D4;"> =&gt; [internal] load build definition from Dockerfile                                                                                                          0.0s</span></span>
<span class="line"><span style="color:#D4D4D4;"> =&gt; =&gt; transferring dockerfile: 778B                                                                                                                          0.0s</span></span>
<span class="line"><span style="color:#D4D4D4;"> =&gt; [internal] load .dockerignore                                                                                                                             0.0s</span></span>
<span class="line"><span style="color:#D4D4D4;"> =&gt; =&gt; transferring context: 2B                                                                                                                               0.0s</span></span>
<span class="line"><span style="color:#D4D4D4;"> =&gt; [internal] load metadata </span><span style="color:#C586C0;">for</span><span style="color:#D4D4D4;"> docker.io/library/golang:1.16.6-alpine                                                                                      13.0s</span></span>
<span class="line"><span style="color:#D4D4D4;"> =&gt; [1/8] FROM docker.io/library/golang:1.16.6-alpine@sha256:bc2db47c5f4a682f1315e0d484811d65bf094d3bcd824459b170714c91656190                                 0.0s</span></span>
<span class="line"><span style="color:#D4D4D4;"> =&gt; [internal] load build context                                                                                                                             1.1s</span></span>
<span class="line"><span style="color:#D4D4D4;"> =&gt; =&gt; transferring context: 50.40MB                                                                                                                          1.1s</span></span>
<span class="line"><span style="color:#D4D4D4;"> =&gt; CACHED [2/8] WORKDIR /repo                                                                                                                                0.0s</span></span>
<span class="line"><span style="color:#D4D4D4;"> =&gt; [3/8] ADD go.mod </span><span style="color:#DCDCAA;">.</span><span style="color:#D4D4D4;">                                                                                                                                        0.2s</span></span>
<span class="line"><span style="color:#D4D4D4;"> =&gt; [4/8] ADD go.sum </span><span style="color:#DCDCAA;">.</span><span style="color:#D4D4D4;">                                                                                                                                        0.0s</span></span>
<span class="line"><span style="color:#D4D4D4;"> =&gt; [5/8] ADD </span><span style="color:#DCDCAA;">.</span><span style="color:#D4D4D4;"> ./                                                                                                                                            0.9s</span></span>
<span class="line"><span style="color:#D4D4D4;"> =&gt; [6/8] RUN sed -i </span><span style="color:#CE9178;">&#39;s/dl-cdn.alpinelinux.org/mirrors.aliyun.com/g&#39;</span><span style="color:#D4D4D4;"> /etc/apk/repositories                                                                    0.6s</span></span>
<span class="line"><span style="color:#D4D4D4;"> =&gt; [7/8] RUN apk add --no-cache bash tzdata                                                                                                                 13.8s</span></span>
<span class="line"><span style="color:#D4D4D4;"> =&gt; [8/8] RUN </span><span style="color:#569CD6;">export</span><span style="color:#D4D4D4;"> GDD_VER=</span><span style="color:#CE9178;">$(go list -mod=vendor -m -f &#39;{{ .Version }}&#39; github.com/unionj-cloud/go-doudou)</span><span style="color:#D4D4D4;"> &amp;&amp; CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go bu  12.4s</span></span>
<span class="line"><span style="color:#D4D4D4;"> =&gt; exporting to image                                                                                                                                        0.7s </span></span>
<span class="line"><span style="color:#D4D4D4;"> =&gt; =&gt; exporting layers                                                                                                                                       0.6s </span></span>
<span class="line"><span style="color:#D4D4D4;"> =&gt; =&gt; writing image sha256:d5c50cfd8ef750eba6a883f14edf2397df1901eadf924b39b9cedda1ad9495cd                                                                  0.0s </span></span>
<span class="line"><span style="color:#D4D4D4;"> =&gt; =&gt; naming to docker.io/library/helloworld                                                                                                                 0.0s </span></span>
<span class="line"><span style="color:#D4D4D4;">                                                                                                                                                                   </span></span>
<span class="line"><span style="color:#D4D4D4;">Use </span><span style="color:#CE9178;">&#39;docker scan&#39;</span><span style="color:#D4D4D4;"> to run Snyk tests against images to find vulnerabilities and learn how to fix them                                                               </span></span>
<span class="line"><span style="color:#D4D4D4;">The push refers to repository [docker.io/wubin1989/helloworld]</span></span>
<span class="line"><span style="color:#D4D4D4;">29d9439ae861: Pushed </span></span>
<span class="line"><span style="color:#D4D4D4;">6e1f1247e3b5: Pushed </span></span>
<span class="line"><span style="color:#D4D4D4;">b2b2a71f9880: Pushed </span></span>
<span class="line"><span style="color:#D4D4D4;">681e9176b1dd: Pushed </span></span>
<span class="line"><span style="color:#D4D4D4;">8e5de385ef21: Pushed </span></span>
<span class="line"><span style="color:#D4D4D4;">0b35a2c6b44d: Pushed </span></span>
<span class="line"><span style="color:#D4D4D4;">152447a5498b: Pushed </span></span>
<span class="line"><span style="color:#D4D4D4;">bb2e1759ebf5: Mounted from library/golang </span></span>
<span class="line"><span style="color:#D4D4D4;">fff907320fc1: Mounted from library/golang </span></span>
<span class="line"><span style="color:#D4D4D4;">6fbdad009c9d: Mounted from library/golang </span></span>
<span class="line"><span style="color:#D4D4D4;">1328cc49ba2b: Mounted from library/golang </span></span>
<span class="line"><span style="color:#D4D4D4;">72e830a4dff5: Mounted from library/golang </span></span>
<span class="line"><span style="color:#D4D4D4;">v20220213230159: digest: sha256:5bc59a7069be59ef670889d52b7bdd6acd62a171bc2415d54375592da793f8cc size: 2831</span></span>
<span class="line"><span style="color:#D4D4D4;">INFO[2022-02-13 23:03:11] image wubin1989/helloworld:v20220213230159 has been pushed successfully </span></span>
<span class="line"><span style="color:#D4D4D4;">INFO[2022-02-13 23:03:11] k8s yaml has been created/updated successfully. execute </span><span style="color:#DCDCAA;">command</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">&#39;go-doudou svc deploy&#39;</span><span style="color:#D4D4D4;"> to deploy service helloworld to k8s cluster</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br></div></div><p>Then you should see there are two yaml files generated: <code>helloworld_deployment.yaml</code> and <code>helloworld_statefulset.yaml</code></p><div class="language-text ext-text line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">\u251C\u2500\u2500 Dockerfile
\u251C\u2500\u2500 client
\u2502\xA0\xA0 \u251C\u2500\u2500 client.go
\u2502\xA0\xA0 \u251C\u2500\u2500 clientproxy.go
\u2502\xA0\xA0 \u2514\u2500\u2500 iclient.go
\u251C\u2500\u2500 cmd
\u2502\xA0\xA0 \u2514\u2500\u2500 main.go
\u251C\u2500\u2500 config
\u2502\xA0\xA0 \u2514\u2500\u2500 config.go
\u251C\u2500\u2500 db
\u2502\xA0\xA0 \u2514\u2500\u2500 db.go
\u251C\u2500\u2500 go.mod
\u251C\u2500\u2500 go.sum
\u251C\u2500\u2500 helloworld_deployment.yaml
\u251C\u2500\u2500 helloworld_openapi3.go
\u251C\u2500\u2500 helloworld_openapi3.json
\u251C\u2500\u2500 helloworld_statefulset.yaml
\u251C\u2500\u2500 main
\u251C\u2500\u2500 svc.go
\u251C\u2500\u2500 svcimpl.go
\u251C\u2500\u2500 transport
\u2502\xA0\xA0 \u2514\u2500\u2500 httpsrv
\u2502\xA0\xA0     \u251C\u2500\u2500 handler.go
\u2502\xA0\xA0     \u251C\u2500\u2500 handlerimpl.go
\u2502\xA0\xA0     \u2514\u2500\u2500 middleware.go
\u2514\u2500\u2500 vo
    \u2514\u2500\u2500 vo.go
</span></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><ul><li>helloworld_deployment.yaml: k8s deploy file for stateless service, recommended to be used for monolith architecture services</li><li>helloworld_statefulset.yaml: k8s deploy file for stateful service, recommended to be used for microservice architecture services</li></ul><h4 id="deploy" tabindex="-1"><a class="header-anchor" href="#deploy" aria-hidden="true">#</a> Deploy</h4>`,7),U={class:"custom-container tip"},L=s("p",{class:"custom-container-title"},"TIP",-1),Y=n("If you haven't installed Docker Desktop, please download and install it from "),V={href:"https://www.docker.com/products/docker-desktop",target:"_blank",rel:"noopener noreferrer"},z=n("https://www.docker.com/products/docker-desktop"),W=n("."),$=s("br",null,null,-1),K=n(" If you are not familiar with docker and kubernetes, please refer to "),Q={href:"https://docs.docker.com/get-started/overview/",target:"_blank",rel:"noopener noreferrer"},J=n("official documentation"),X=n(" to learn more."),Z=l(`<p>By default, <code>go-doudou svc deploy</code> command uses <code>helloworld_statefulset.yaml</code> to deploy the service as statefulset application.</p><div class="language-bash ext-sh line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">go-doudou svc deploy</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>Then run <code>kubectl get pods</code> and you should see our service is running.</p><div class="language-bash ext-sh line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">\u279C  helloworld git:(master) \u2717 kubectl get pods    </span></span>
<span class="line"><span style="color:#D4D4D4;">NAME                       READY   STATUS    RESTARTS   AGE</span></span>
<span class="line"><span style="color:#D4D4D4;">helloworld-statefulset-0   1/1     Running   0          11m</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>At the moment, you can&#39;t connect to our service via <code>http://localhost:6060</code>. You should setup proxy by running below commands:</p><div class="language-bash ext-sh line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#569CD6;">export</span><span style="color:#D4D4D4;"> POD_NAME=</span><span style="color:#CE9178;">$(kubectl get pods --namespace default -l &quot;app=helloworld&quot; -o jsonpath=&quot;{.items[0].metadata.name}&quot;)</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>and</p><div class="language-bash ext-sh line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">kubectl port-forward --namespace default </span><span style="color:#9CDCFE;">$POD_NAME</span><span style="color:#D4D4D4;"> 6060:6060 </span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>If you see below output from command line, you can test by postman now.</p><div class="language-bash ext-sh line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">\u279C  helloworld git:(master) \u2717 </span><span style="color:#569CD6;">export</span><span style="color:#D4D4D4;"> POD_NAME=</span><span style="color:#CE9178;">$(kubectl get pods --namespace default -l &quot;app=helloworld&quot; -o jsonpath=&quot;{.items[0].metadata.name}&quot;)</span></span>
<span class="line"><span style="color:#D4D4D4;">\u279C  helloworld git:(master) \u2717 kubectl port-forward --namespace default </span><span style="color:#9CDCFE;">$POD_NAME</span><span style="color:#D4D4D4;"> 6060:6060                                               </span></span>
<span class="line"><span style="color:#D4D4D4;">Forwarding from 127.0.0.1:6060 -&gt; 6060</span></span>
<span class="line"><span style="color:#D4D4D4;">Forwarding from [::1]:6060 -&gt; 6060</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h4 id="shutdown" tabindex="-1"><a class="header-anchor" href="#shutdown" aria-hidden="true">#</a> Shutdown</h4><p>Run <code>go-doudou svc shutdown</code> to stop the service.</p><div class="language-bash ext-sh line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">go-doudou svc shutdown</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>Then run <code>kubectl get pods</code> again, you should see below output.</p><div class="language-bash ext-sh line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">\u279C  helloworld git:(master) \u2717 kubectl get pods                                                                                             </span></span>
<span class="line"><span style="color:#D4D4D4;">No resources found </span><span style="color:#C586C0;">in</span><span style="color:#D4D4D4;"> default namespace.</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div>`,15);function ss(ns,as){const o=p("RouterLink"),e=p("ExternalLinkIcon");return c(),i(t,null,[m,s("p",null,[y,g,h,f,v,_,C,E,a(o,{to:"/guide/idl.html"},{default:r(()=>[k]),_:1}),w]),x,s("ul",null,[A,j,s("li",null,[I,s("a",q,[B,a(e)])]),N,O,P,F,R]),T,s("p",null,[G,a(o,{to:"/guide/deployment.html"},{default:r(()=>[H]),_:1}),S]),M,s("div",U,[L,s("p",null,[Y,s("a",V,[z,a(e)]),W,$,K,s("a",Q,[J,a(e)]),X])]),Z],64)}var ps=d(b,[["render",ss]]);export{ps as default};
