<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.35">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <link rel="icon" type="image/x-icon" sizes="32x32" href="/favicon.ico"><script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?658d535852e4dcdd8f3934c1c3e87165";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script><meta name="keywords" content="go-doudou,Go语言微服务框架,golang,go-doudou微服务框架,RESTful,微服务,服务注册与发现,负载均衡,熔断限流,grpc,去中心化,golang microservice framework,golang orm,ORM工具,microservice,service discovery,load balancing,circuit breaker,rate limit,低代码平台"><meta name="description" content="go-doudou是一个go语言微服务框架。它同时支持开发单体应用。从定义Go语言接口开始，无须学习任何接口描述语言。内置基于SWIM gossip协议的服务注册与发现的机制，帮助你构建一个健壮的、可扩展的、去中心化的微服务集群。内置强大的代码生成器。"><title>Configuration | go-doudou</title>
    <link rel="modulepreload" href="/assets/app.2025f35b.js"><link rel="modulepreload" href="/assets/configuration.html.91f59f9c.js"><link rel="modulepreload" href="/assets/configuration.html.72ab06df.js"><link rel="modulepreload" href="/assets/plugin-vue_export-helper.21dcd24c.js">
    <link rel="stylesheet" href="/assets/style.993d40d8.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header ref_key="navbar" class="navbar"><div class="toggle-sidebar-button" title="Toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/" class=""><img class="logo" src="/logo.png" alt="go-doudou"><span class="site-name can-hide">go-doudou</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><a href="/guide/" class="router-link-active" aria-label="Guide"><!--[--><!--]--> Guide <!--[--><!--]--></a></div><div class="navbar-item"><a href="/resources/" class="" aria-label="Resources"><!--[--><!--]--> Resources <!--[--><!--]--></a></div><div class="navbar-item"><a href="/blog/" class="" aria-label="Blog"><!--[--><!--]--> Blog <!--[--><!--]--></a></div><div class="navbar-item"><a href="/contribution/" class="" aria-label="Contribution"><!--[--><!--]--> Contribution <!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://github.com/unionj-cloud/go-doudou/releases" rel="noopener noreferrer" target="_blank" aria-label="Release Notes"><!--[--><!--]--> Release Notes <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">Open in new window</span></span><!--[--><!--]--></a></div><div class="navbar-item"><a href="/zh/" class="" aria-label="中文"><!--[--><!--]--> 中文 <!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Select language"><span class="title">Languages</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Select language"><span class="title">Languages</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a aria-current="page" href="/guide/configuration.html" class="router-link-active router-link-exact-active router-link-active" aria-label="English"><!--[--><!--]--> English <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/zh/guide/configuration.html" class="" aria-label="简体中文"><!--[--><!--]--> 简体中文 <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><a class="external-link" href="https://github.com/unionj-cloud/go-doudou" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">Open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-dark-button" title="Toggle dark mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><a href="/guide/" class="router-link-active" aria-label="Guide"><!--[--><!--]--> Guide <!--[--><!--]--></a></div><div class="navbar-item"><a href="/resources/" class="" aria-label="Resources"><!--[--><!--]--> Resources <!--[--><!--]--></a></div><div class="navbar-item"><a href="/blog/" class="" aria-label="Blog"><!--[--><!--]--> Blog <!--[--><!--]--></a></div><div class="navbar-item"><a href="/contribution/" class="" aria-label="Contribution"><!--[--><!--]--> Contribution <!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://github.com/unionj-cloud/go-doudou/releases" rel="noopener noreferrer" target="_blank" aria-label="Release Notes"><!--[--><!--]--> Release Notes <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">Open in new window</span></span><!--[--><!--]--></a></div><div class="navbar-item"><a href="/zh/" class="" aria-label="中文"><!--[--><!--]--> 中文 <!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Select language"><span class="title">Languages</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Select language"><span class="title">Languages</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a aria-current="page" href="/guide/configuration.html" class="router-link-active router-link-exact-active router-link-active" aria-label="English"><!--[--><!--]--> English <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/zh/guide/configuration.html" class="" aria-label="简体中文"><!--[--><!--]--> 简体中文 <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><a class="external-link" href="https://github.com/unionj-cloud/go-doudou" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">Open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><p tabindex="0" class="sidebar-item sidebar-heading active">Guide <!----></p><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a href="/guide/" class="router-link-active sidebar-item" aria-label="Introduction"><!--[--><!--]--> Introduction <!--[--><!--]--></a><!----></li><li><a href="/guide/getting-started.html" class="sidebar-item" aria-label="Getting Started"><!--[--><!--]--> Getting Started <!--[--><!--]--></a><!----></li><li><a href="/guide/idl.html" class="sidebar-item" aria-label="Define API"><!--[--><!--]--> Define API <!--[--><!--]--></a><!----></li><li><a href="/guide/cli.html" class="sidebar-item" aria-label="CLI Commands"><!--[--><!--]--> CLI Commands <!--[--><!--]--></a><!----></li><li><a href="/guide/generation.html" class="sidebar-item" aria-label="Code Generation Rules"><!--[--><!--]--> Code Generation Rules <!--[--><!--]--></a><!----></li><li><a href="/guide/rest.html" class="sidebar-item" aria-label="REST"><!--[--><!--]--> REST <!--[--><!--]--></a><!----></li><li><a href="/guide/grpc.html" class="sidebar-item" aria-label="gRPC"><!--[--><!--]--> gRPC <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/guide/configuration.html" class="router-link-active router-link-exact-active router-link-active sidebar-item active" aria-label="Configuration"><!--[--><!--]--> Configuration <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/guide/configuration.html#local-configuration-files" class="router-link-active router-link-exact-active sidebar-item" aria-label="Local Configuration Files"><!--[--><!--]--> Local Configuration Files <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/guide/configuration.html#dotenv-files" class="router-link-active router-link-exact-active sidebar-item" aria-label="dotenv Files"><!--[--><!--]--> dotenv Files <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/guide/configuration.html#yaml-files" class="router-link-active router-link-exact-active sidebar-item" aria-label="yaml Files"><!--[--><!--]--> yaml Files <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><a aria-current="page" href="/guide/configuration.html#remote-configuration-solutions" class="router-link-active router-link-exact-active sidebar-item" aria-label="Remote Configuration Solutions"><!--[--><!--]--> Remote Configuration Solutions <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/guide/configuration.html#nacos-configuration-center" class="router-link-active router-link-exact-active sidebar-item" aria-label="Nacos Configuration Center"><!--[--><!--]--> Nacos Configuration Center <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/guide/configuration.html#apollo-configuration-center" class="router-link-active router-link-exact-active sidebar-item" aria-label="Apollo Configuration Center"><!--[--><!--]--> Apollo Configuration Center <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><a aria-current="page" href="/guide/configuration.html#service-configuration" class="router-link-active router-link-exact-active sidebar-item" aria-label="Service Configuration"><!--[--><!--]--> Service Configuration <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/guide/configuration.html#nacos-configuration" class="router-link-active router-link-exact-active sidebar-item" aria-label="Nacos Configuration"><!--[--><!--]--> Nacos Configuration <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/guide/configuration.html#apollo-configuration" class="router-link-active router-link-exact-active sidebar-item" aria-label="Apollo Configuration"><!--[--><!--]--> Apollo Configuration <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/guide/configuration.html#etcd-configuration" class="router-link-active router-link-exact-active sidebar-item" aria-label="Etcd Configuration"><!--[--><!--]--> Etcd Configuration <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/guide/configuration.html#zookeeper-configuration" class="router-link-active router-link-exact-active sidebar-item" aria-label="Zookeeper Configuration"><!--[--><!--]--> Zookeeper Configuration <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/guide/configuration.html#memberlist-configuration" class="router-link-active router-link-exact-active sidebar-item" aria-label="Memberlist Configuration"><!--[--><!--]--> Memberlist Configuration <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/guide/configuration.html#cache-configuration" class="router-link-active router-link-exact-active sidebar-item" aria-label="Cache Configuration"><!--[--><!--]--> Cache Configuration <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/guide/configuration.html#gorm-configuration" class="router-link-active router-link-exact-active sidebar-item" aria-label="Gorm Configuration"><!--[--><!--]--> Gorm Configuration <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><a href="/guide/deployment.html" class="sidebar-item" aria-label="Deployment"><!--[--><!--]--> Deployment <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><h1 id="configuration" tabindex="-1"><a class="header-anchor" href="#configuration" aria-hidden="true">#</a> Configuration</h1><p><code>go-doudou</code> provides out-of-the-box support for local configuration files in dotenv and yaml formats, as well as Alibaba&#39;s Nacos and Ctrip&#39;s Apollo configuration centers. It can load configurations from local files or remote configuration centers into environment variables.</p><p>The priority between local configuration files and remote configuration centers is that local configuration files take precedence, meaning configurations already loaded from local files will not be overridden by those loaded from remote configuration centers.</p><h2 id="local-configuration-files" tabindex="-1"><a class="header-anchor" href="#local-configuration-files" aria-hidden="true">#</a> Local Configuration Files</h2><p>The usage of dotenv format and yaml format local configuration files is exactly the same, with only slight differences in file naming rules. These are explained separately below.</p><div class="custom-container tip"><p class="custom-container-title">Tip</p><p>The two configuration file formats can be used simultaneously or you can use just one. When used simultaneously, yaml format configuration files are loaded first, and after all yaml files are loaded, dotenv format configuration files are loaded.</p></div><h3 id="dotenv-files" tabindex="-1"><a class="header-anchor" href="#dotenv-files" aria-hidden="true">#</a> dotenv Files</h3><p>If you have multiple <code>.env</code> files, such as <code>.env.test</code>, <code>.env.prod</code>, etc., to configure different environments, you can set the <code>GDD_ENV</code> environment variable to <code>test</code> or <code>prod</code> through the command line terminal, <code>Dockerfile</code>, or k8s configuration files to load the corresponding configuration file.</p><p>The configuration loading rules are as follows:</p><ol><li>For the same environment variable, whether configured in the command line terminal or through configuration files, the value loaded first has the highest priority and will not be modified by subsequently loaded values.</li><li>The loading order of configuration files (taking the <code>prod</code> environment as an example) is: 1. Load <code>.env.prod.local</code> file 2. When the value of the environment variable <code>GDD_ENV</code> is <strong>not</strong> equal to <code>test</code>, load <code>.env.local</code> file 3. Load <code>.env.prod</code> file 4. Load <code>.env</code> file</li></ol><p><strong>Note</strong>: The prefix must be <code>.env</code></p><h3 id="yaml-files" tabindex="-1"><a class="header-anchor" href="#yaml-files" aria-hidden="true">#</a> yaml Files</h3><p>Supports both <code>.yml</code> and <code>.yaml</code> suffix configuration files. If you have multiple yaml files, such as <code>app-test.yml</code>, <code>app-prod.yml</code>, etc., to configure different environments, you can set the <code>GDD_ENV</code> environment variable to <code>test</code> or <code>prod</code> through the command line terminal, <code>Dockerfile</code>, or k8s configuration files to load the corresponding configuration file.</p><p>The configuration loading rules are as follows:</p><ol><li>For the same environment variable, whether configured in the command line terminal or through configuration files, the value loaded first has the highest priority and will not be modified by subsequently loaded values.</li><li>The loading order of configuration files (taking the <code>prod</code> environment as an example) is: 1. Load <code>app-prod-local.yml</code> file 2. When the value of the environment variable <code>GDD_ENV</code> is <strong>not</strong> equal to <code>test</code>, load <code>app-local.yml</code> file 3. Load <code>app-prod.yml</code> file 4. Load <code>app.yml</code> file</li></ol><p><strong>Note</strong>: The prefix must be <code>app</code></p><div class="custom-container tip"><p class="custom-container-title">Tip</p><p>When converting environment variables to yaml configuration, the rule is to use underscores as property separators. For very long property names, hyphens can be used to split them into multiple words for better readability. For example, the environment variable GDD_DB_MYSQL_DISABLEDATETIMEPRECISION converted to yaml configuration:</p><div class="language-yaml ext-yml line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#569CD6;">gdd</span><span style="color:#D4D4D4;">:</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#569CD6;">db</span><span style="color:#D4D4D4;">:</span></span>
<span class="line"><span style="color:#D4D4D4;">		</span><span style="color:#569CD6;">mysql</span><span style="color:#D4D4D4;">:</span></span>
<span class="line"><span style="color:#D4D4D4;">			</span><span style="color:#569CD6;">disable-datetime-precision</span><span style="color:#D4D4D4;">:</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></div><h2 id="remote-configuration-solutions" tabindex="-1"><a class="header-anchor" href="#remote-configuration-solutions" aria-hidden="true">#</a> Remote Configuration Solutions</h2><p><code>go-doudou</code> has built-in support for two remote configuration center solutions: Alibaba&#39;s Nacos and Ctrip&#39;s Apollo. It supports loading at service startup and also supports custom listener functions to monitor configuration changes.</p><p>To enable a remote configuration center, you need to configure the following environment variables in the local configuration file:</p><ul><li><code>GDD_CONFIG_REMOTE_TYPE</code>: Remote configuration center name, options: <code>nacos</code>, <code>apollo</code></li></ul><div class="custom-container tip"><p class="custom-container-title">Tip</p><p>Some of the <a href="#service-configuration">service configurations</a> in the <code>go-doudou</code> framework layer (i.e., configurations with the <code>GDD_</code> prefix) support runtime dynamic modification through remote configuration centers. The priority of runtime dynamic modifications is the highest and will override all configurations loaded from the command line terminal, <code>Dockerfile</code>, k8s configuration files, local configuration files, and remote configuration centers at service startup.</p></div><h3 id="nacos-configuration-center" tabindex="-1"><a class="header-anchor" href="#nacos-configuration-center" aria-hidden="true">#</a> Nacos Configuration Center</h3><p><code>go-doudou</code> service will automatically load configurations from Nacos at startup. You only need to configure some parameters in the local configuration file, making it ready to use out of the box.</p><ul><li><code>GDD_NACOS_NAMESPACE_ID</code>: Nacos namespaceId, optional</li><li><code>GDD_NACOS_SERVER_ADDR</code>: Nacos server connection address, required</li><li><code>GDD_NACOS_CONFIG_FORMAT</code>: Configuration format, options: <code>dotenv</code>, <code>yaml</code>, default is <code>dotenv</code></li><li><code>GDD_NACOS_CONFIG_GROUP</code>: Nacos group, default is <code>DEFAULT_GROUP</code></li><li><code>GDD_NACOS_CONFIG_DATAID</code>: Nacos dataId, required, multiple dataIds separated by commas, the order in the configuration is the actual loading order, following the rule that configurations loaded first have the highest priority</li></ul><p>The <code>configmgr</code> package provides an exported singleton <code>NacosClient</code> for interacting with the Nacos configuration center. You can call the <code>AddChangeListener</code> method to add custom listener functions. Example usage:</p><div class="language-go ext-go line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#569CD6;">func</span><span style="color:#D4D4D4;"> </span><span style="color:#DCDCAA;">main</span><span style="color:#D4D4D4;">() {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D4D4D4;">	...</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#C586C0;">if</span><span style="color:#D4D4D4;"> configmgr.NacosClient != </span><span style="color:#569CD6;">nil</span><span style="color:#D4D4D4;"> {</span></span>
<span class="line"><span style="color:#D4D4D4;">		configmgr.NacosClient.</span><span style="color:#DCDCAA;">AddChangeListener</span><span style="color:#D4D4D4;">(configmgr.NacosConfigListenerParam{</span></span>
<span class="line"><span style="color:#D4D4D4;">			DataId: </span><span style="color:#CE9178;">&quot;statsvc-dev&quot;</span><span style="color:#D4D4D4;">,</span></span>
<span class="line"><span style="color:#D4D4D4;">			OnChange: </span><span style="color:#569CD6;">func</span><span style="color:#D4D4D4;">(event *configmgr.NacosChangeEvent) {</span></span>
<span class="line"><span style="color:#D4D4D4;">				fmt.</span><span style="color:#DCDCAA;">Println</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&quot;group:&quot;</span><span style="color:#D4D4D4;"> + event.Group + </span><span style="color:#CE9178;">&quot;, dataId:&quot;</span><span style="color:#D4D4D4;"> + event.DataId + fmt.</span><span style="color:#DCDCAA;">Sprintf</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&quot;, changes: </span><span style="color:#9CDCFE;">%+v</span><span style="color:#D7BA7D;">\n</span><span style="color:#CE9178;">&quot;</span><span style="color:#D4D4D4;">, event.Changes))</span></span>
<span class="line"><span style="color:#D4D4D4;">			},</span></span>
<span class="line"><span style="color:#D4D4D4;">		})</span></span>
<span class="line"><span style="color:#D4D4D4;">	}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D4D4D4;">	...</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D4D4D4;">	srv.</span><span style="color:#DCDCAA;">Run</span><span style="color:#D4D4D4;">()</span></span>
<span class="line"><span style="color:#D4D4D4;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h3 id="apollo-configuration-center" tabindex="-1"><a class="header-anchor" href="#apollo-configuration-center" aria-hidden="true">#</a> Apollo Configuration Center</h3><p><code>go-doudou</code> service will automatically load configurations from Apollo at startup. You only need to configure some parameters in the local configuration file, making it ready to use out of the box.</p><ul><li><code>GDD_SERVICE_NAME</code>: Service name is the Apollo AppId</li><li><code>GDD_APOLLO_CLUSTER</code>: Apollo cluster, default is <code>default</code></li><li><code>GDD_APOLLO_ADDR</code>: Apollo server connection address, required</li><li><code>GDD_APOLLO_NAMESPACE</code>: Apollo namespace, equivalent to Nacos&#39;s dataId, default is <code>application.properties</code>, multiple namespaces separated by commas, the order in the configuration is the actual loading order, following the rule that configurations loaded first have the highest priority</li><li><code>GDD_APOLLO_SECRET</code>: Apollo configuration secret, optional</li></ul><p>The <code>configmgr</code> package provides an exported singleton <code>ApolloClient</code> for interacting with the Apollo configuration center. You can call the <code>AddChangeListener</code> method to add custom listener functions. Example usage:</p><div class="language-go ext-go line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#569CD6;">type</span><span style="color:#D4D4D4;"> </span><span style="color:#4EC9B0;">ConfigChangeListener</span><span style="color:#D4D4D4;"> </span><span style="color:#569CD6;">struct</span><span style="color:#D4D4D4;"> {</span></span>
<span class="line"><span style="color:#D4D4D4;">	configmgr.BaseApolloListener</span></span>
<span class="line"><span style="color:#D4D4D4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">func</span><span style="color:#D4D4D4;"> (c *ConfigChangeListener) </span><span style="color:#DCDCAA;">OnChange</span><span style="color:#D4D4D4;">(event *storage.ChangeEvent) {</span></span>
<span class="line"><span style="color:#D4D4D4;">	c.Lock.</span><span style="color:#DCDCAA;">Lock</span><span style="color:#D4D4D4;">()</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#C586C0;">defer</span><span style="color:#D4D4D4;"> c.Lock.</span><span style="color:#DCDCAA;">Unlock</span><span style="color:#D4D4D4;">()</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#C586C0;">if</span><span style="color:#D4D4D4;"> !c.SkippedFirstEvent {</span></span>
<span class="line"><span style="color:#D4D4D4;">		</span><span style="color:#9CDCFE;">c.SkippedFirstEvent</span><span style="color:#D4D4D4;"> = </span><span style="color:#569CD6;">true</span></span>
<span class="line"><span style="color:#D4D4D4;">		</span><span style="color:#C586C0;">return</span></span>
<span class="line"><span style="color:#D4D4D4;">	}</span></span>
<span class="line"><span style="color:#D4D4D4;">	logger.</span><span style="color:#DCDCAA;">Info</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&quot;from OnChange&quot;</span><span style="color:#D4D4D4;">)</span></span>
<span class="line"><span style="color:#D4D4D4;">	fmt.</span><span style="color:#DCDCAA;">Println</span><span style="color:#D4D4D4;">(event.Changes)</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#C586C0;">for</span><span style="color:#D4D4D4;"> </span><span style="color:#9CDCFE;">key</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">value</span><span style="color:#D4D4D4;"> := </span><span style="color:#C586C0;">range</span><span style="color:#D4D4D4;"> event.Changes {</span></span>
<span class="line"><span style="color:#D4D4D4;">		fmt.</span><span style="color:#DCDCAA;">Println</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&quot;change key : &quot;</span><span style="color:#D4D4D4;">, key, </span><span style="color:#CE9178;">&quot;, value :&quot;</span><span style="color:#D4D4D4;">, value)</span></span>
<span class="line"><span style="color:#D4D4D4;">	}</span></span>
<span class="line"><span style="color:#D4D4D4;">	fmt.</span><span style="color:#DCDCAA;">Println</span><span style="color:#D4D4D4;">(event.Namespace)</span></span>
<span class="line"><span style="color:#D4D4D4;">	logger.</span><span style="color:#DCDCAA;">Info</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&quot;from OnChange end&quot;</span><span style="color:#D4D4D4;">)</span></span>
<span class="line"><span style="color:#D4D4D4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">func</span><span style="color:#D4D4D4;"> </span><span style="color:#DCDCAA;">main</span><span style="color:#D4D4D4;">() {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D4D4D4;">    ...</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#569CD6;">var</span><span style="color:#D4D4D4;"> </span><span style="color:#9CDCFE;">listener</span><span style="color:#D4D4D4;"> ConfigChangeListener</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D4D4D4;">	configmgr.ApolloClient.</span><span style="color:#DCDCAA;">AddChangeListener</span><span style="color:#D4D4D4;">(&amp;listener)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D4D4D4;">    ...</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D4D4D4;">	srv.</span><span style="color:#DCDCAA;">Run</span><span style="color:#D4D4D4;">()</span></span>
<span class="line"><span style="color:#D4D4D4;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br></div></div><p>It&#39;s worth noting that the first configuration loading event will also be detected by custom listener functions. If you need to skip the first time, you need to &quot;inherit&quot; the <code>BaseApolloListener</code> struct provided by the <code>configmgr</code> package, and then add the following code at the beginning of the <code>OnChange</code> function:</p><div class="language-go ext-go line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">c.Lock.</span><span style="color:#DCDCAA;">Lock</span><span style="color:#D4D4D4;">()</span></span>
<span class="line"><span style="color:#C586C0;">defer</span><span style="color:#D4D4D4;"> c.Lock.</span><span style="color:#DCDCAA;">Unlock</span><span style="color:#D4D4D4;">()</span></span>
<span class="line"><span style="color:#C586C0;">if</span><span style="color:#D4D4D4;"> !c.SkippedFirstEvent {</span></span>
<span class="line"><span style="color:#D4D4D4;">  </span><span style="color:#9CDCFE;">c.SkippedFirstEvent</span><span style="color:#D4D4D4;"> = </span><span style="color:#569CD6;">true</span></span>
<span class="line"><span style="color:#D4D4D4;">  </span><span style="color:#C586C0;">return</span></span>
<span class="line"><span style="color:#D4D4D4;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h2 id="service-configuration" tabindex="-1"><a class="header-anchor" href="#service-configuration" aria-hidden="true">#</a> Service Configuration</h2><p>Configurations marked with a red asterisk in the table are dynamically modified by go-doudou at runtime by monitoring configuration changes in the remote configuration center.</p><table><thead><tr><th>Environment Variable</th><th>Description</th><th>Default Value</th><th>Required</th></tr></thead><tbody><tr><td>GDD_BANNER</td><td>Enable banner</td><td>true</td><td></td></tr><tr><td>GDD_BANNER_TEXT</td><td>Banner text</td><td><code>go-doudou</code></td><td></td></tr><tr><td>GDD_LOG_LEVEL</td><td>Log level, options: <code>panic</code>, <code>fatal</code>, <code>error</code>, <code>warn</code>, <code>warning</code>, <code>info</code>, <code>debug</code>, <code>trace</code></td><td>info</td><td></td></tr><tr><td>GDD_LOG_FORMAT</td><td>Log format, options: <code>text</code>, <code>json</code></td><td>text</td><td></td></tr><tr><td>GDD_LOG_REQ_ENABLE</td><td>Enable HTTP request and response body logging</td><td>false</td><td></td></tr><tr><td>GDD_LOG_CALLER</td><td>Print &quot;filename:line&quot;</td><td>true</td><td></td></tr><tr><td>GDD_LOG_DISCARD</td><td>Disable logging</td><td>false</td><td></td></tr><tr><td>GDD_LOG_PATH</td><td>Log file path, if set, logs will be written to the file</td><td></td><td></td></tr><tr><td>GDD_LOG_STYLE</td><td>Log format style, only valid when GDD_LOG_PATH is set, options: <code>json</code> or <code>console</code></td><td>json</td><td></td></tr><tr><td>GDD_GRACE_TIMEOUT</td><td>Graceful shutdown timeout</td><td>15s</td><td></td></tr><tr><td>GDD_WRITE_TIMEOUT</td><td>HTTP connection write timeout</td><td>15s</td><td></td></tr><tr><td>GDD_READ_TIMEOUT</td><td>HTTP connection read timeout</td><td>15s</td><td></td></tr><tr><td>GDD_IDLE_TIMEOUT</td><td>HTTP connection idle timeout</td><td>60s</td><td></td></tr><tr><td>GDD_ROUTE_ROOT_PATH</td><td>HTTP request path prefix</td><td></td><td></td></tr><tr><td>GDD_SERVICE_NAME</td><td>Service name</td><td></td><td>Required</td></tr><tr><td>GDD_SERVICE_GROUP</td><td>Service group name, valid when using zookeeper for service registration and discovery</td><td></td><td></td></tr><tr><td>GDD_SERVICE_VERSION</td><td>Service version name, valid when using zookeeper for service registration and discovery</td><td></td><td></td></tr><tr><td>GDD_HOST</td><td>HTTP server listening address</td><td></td><td></td></tr><tr><td>GDD_PORT</td><td>HTTP server listening port</td><td>6060</td><td></td></tr><tr><td>GDD_GRPC_PORT</td><td>gRPC server listening port</td><td>50051</td><td></td></tr><tr><td>GDD_RETRY_COUNT</td><td>Client request retry count</td><td>0</td><td></td></tr><tr><td>GDD_MANAGE_ENABLE</td><td>Enable built-in HTTP interfaces: <code>/go-doudou/doc</code>, <code>/go-doudou/openapi.json</code>, <code>/go-doudou/prometheus</code>, <code>/go-doudou/registry</code>, <code>/go-doudou/config</code></td><td>true</td><td></td></tr><tr><td><span style="color:red;font-weight:bold;">*</span>GDD_MANAGE_USER</td><td>HTTP basic authentication username for built-in HTTP interfaces</td><td>admin</td><td></td></tr><tr><td><span style="color:red;font-weight:bold;">*</span>GDD_MANAGE_PASS</td><td>HTTP basic authentication password for built-in HTTP interfaces</td><td>admin</td><td></td></tr><tr><td>GDD_TRACING_METRICS_ROOT</td><td><code>metrics root</code> for jaeger call chain monitoring</td><td>tracing</td><td></td></tr><tr><td>GDD_WEIGHT</td><td>Service instance weight</td><td>1</td><td></td></tr><tr><td>GDD_SERVICE_DISCOVERY_MODE</td><td>Service discovery mode, options: <code>etcd</code>, <code>nacos</code>, <code>zk</code></td><td></td><td></td></tr><tr><td>GDD_ENABLE_RESPONSE_GZIP</td><td>Enable HTTP response body gzip compression</td><td>true</td><td></td></tr><tr><td>GDD_SQL_LOG_ENABLE</td><td>Enable SQL log printing</td><td>false</td><td></td></tr><tr><td>GDD_REGISTER_HOST</td><td>Service instance registration address, default is the host&#39;s private IP</td><td></td><td></td></tr><tr><td>GDD_FALLBACK_CONTENTTYPE</td><td>Default Content-Type header for HTTP response body</td><td>application/json; charset=UTF-8</td><td></td></tr><tr><td>GDD_CONFIG_REMOTE_TYPE</td><td>Remote configuration center, options: <code>nacos</code>, <code>apollo</code></td><td></td><td></td></tr><tr><td>GDD_ROUTER_SAVEMATCHEDROUTEPATH</td><td>Save matched route path</td><td>true</td><td></td></tr><tr><td>GDD_STATS_FREQ</td><td>Service status statistics frequency</td><td>1s</td><td></td></tr></tbody></table><h2 id="nacos-configuration" tabindex="-1"><a class="header-anchor" href="#nacos-configuration" aria-hidden="true">#</a> Nacos Configuration</h2><table><thead><tr><th>Environment Variable</th><th>Description</th><th>Default Value</th><th>Required</th></tr></thead><tbody><tr><td>GDD_NACOS_NAMESPACE_ID</td><td>Namespace</td><td>public</td><td></td></tr><tr><td>GDD_NACOS_TIMEOUT_MS</td><td>Request timeout in milliseconds</td><td>10000</td><td></td></tr><tr><td>GDD_NACOS_NOTLOADCACHEATSTART</td><td>Whether to load service list from disk cache at program startup</td><td>false</td><td></td></tr><tr><td>GDD_NACOS_LOG_DIR</td><td>Log directory path</td><td>/tmp/nacos/log</td><td></td></tr><tr><td>GDD_NACOS_CACHE_DIR</td><td>Service list disk cache path</td><td>/tmp/nacos/cache</td><td></td></tr><tr><td>GDD_NACOS_LOG_LEVEL</td><td>Log level, options: <code>debug</code>, <code>info</code>, <code>warn</code>, <code>error</code></td><td>info</td><td></td></tr><tr><td>GDD_NACOS_LOG_DISCARD</td><td>Disable Nacos logging</td><td>false</td><td></td></tr><tr><td>GDD_NACOS_SERVER_ADDR</td><td>Nacos server connection address, multiple addresses separated by commas</td><td></td><td></td></tr><tr><td>GDD_NACOS_REGISTER_HOST</td><td>IP address used for Nacos service registration</td><td></td><td></td></tr><tr><td>GDD_NACOS_CLUSTER_NAME</td><td>Nacos cluster name</td><td>DEFAULT</td><td></td></tr><tr><td>GDD_NACOS_GROUP_NAME</td><td>Nacos group name</td><td>DEFAULT_GROUP</td><td></td></tr><tr><td>GDD_NACOS_CONFIG_FORMAT</td><td>Configuration data format, supports: <code>dotenv</code>, <code>yaml</code></td><td>dotenv</td><td></td></tr><tr><td>GDD_NACOS_CONFIG_GROUP</td><td>Configuration group</td><td>DEFAULT_GROUP</td><td></td></tr><tr><td>GDD_NACOS_CONFIG_DATAID</td><td>Configuration dataId</td><td></td><td>Required</td></tr></tbody></table><h2 id="apollo-configuration" tabindex="-1"><a class="header-anchor" href="#apollo-configuration" aria-hidden="true">#</a> Apollo Configuration</h2><table><thead><tr><th>Environment Variable</th><th>Description</th><th>Default Value</th><th>Required</th></tr></thead><tbody><tr><td>GDD_APOLLO_CLUSTER</td><td>Apollo cluster</td><td>default</td><td></td></tr><tr><td>GDD_APOLLO_ADDR</td><td>Apollo configuration service connection address</td><td></td><td>Required</td></tr><tr><td>GDD_APOLLO_NAMESPACE</td><td>Apollo namespace</td><td>application.properties</td><td></td></tr><tr><td>GDD_APOLLO_BACKUP_ENABLE</td><td>Enable configuration caching on local disk</td><td>true</td><td></td></tr><tr><td>GDD_APOLLO_BACKUP_PATH</td><td>Configuration cache folder path</td><td></td><td></td></tr><tr><td>GDD_APOLLO_MUSTSTART</td><td>Return error immediately if configuration service connection fails</td><td>false</td><td></td></tr><tr><td>GDD_APOLLO_SECRET</td><td>Apollo configuration secret</td><td></td><td></td></tr><tr><td>GDD_APOLLO_LOG_ENABLE</td><td>Enable Apollo log printing</td><td>false</td><td></td></tr></tbody></table><h2 id="etcd-configuration" tabindex="-1"><a class="header-anchor" href="#etcd-configuration" aria-hidden="true">#</a> Etcd Configuration</h2><table><thead><tr><th>Environment Variable</th><th>Description</th><th>Default Value</th><th>Required</th></tr></thead><tbody><tr><td>GDD_ETCD_ENDPOINTS</td><td>Etcd cluster connection address</td><td></td><td></td></tr><tr><td>GDD_ETCD_LEASE</td><td>Etcd service registration lease TTL time in seconds</td><td>5</td><td></td></tr></tbody></table><h2 id="zookeeper-configuration" tabindex="-1"><a class="header-anchor" href="#zookeeper-configuration" aria-hidden="true">#</a> Zookeeper Configuration</h2><table><thead><tr><th>Environment Variable</th><th>Description</th><th>Default Value</th><th>Required</th></tr></thead><tbody><tr><td>GDD_ZK_SERVERS</td><td>Zookeeper cluster connection address, multiple addresses separated by commas</td><td></td><td></td></tr><tr><td>GDD_ZK_SEQUENCE</td><td>Whether to add a sequence number to Zookeeper nodes</td><td>false</td><td></td></tr><tr><td>GDD_ZK_DIRECTORY_PATTERN</td><td>String fmt pattern for service registration node path, %s represents service name</td><td>/registry/%s/providers</td><td></td></tr></tbody></table><h2 id="memberlist-configuration" tabindex="-1"><a class="header-anchor" href="#memberlist-configuration" aria-hidden="true">#</a> Memberlist Configuration</h2><p>Memberlist is a built-in service registration and discovery component in the go-doudou framework based on the gossip protocol.</p><table><thead><tr><th>Environment Variable</th><th>Description</th><th>Default Value</th><th>Required</th></tr></thead><tbody><tr><td>GDD_MEM_SEED</td><td>Cluster seed nodes for joining</td><td></td><td></td></tr><tr><td>GDD_MEM_NAME</td><td>Unique name of the node in the cluster, hostname will be used if not set</td><td></td><td></td></tr><tr><td>GDD_MEM_HOST</td><td>Advertise address of the node, if starting with a dot (like .seed-svc), will be prefixed with hostname, supports K8s stateful services</td><td></td><td></td></tr><tr><td>GDD_MEM_PORT</td><td>Node communication port, randomly assigned if not set</td><td>7946</td><td></td></tr><tr><td>GDD_MEM_DEAD_TIMEOUT</td><td>Node death timeout in seconds, node will be removed if no refute messages are received within this time</td><td>60s</td><td></td></tr><tr><td>GDD_MEM_SYNC_INTERVAL</td><td>Node state synchronization interval in seconds</td><td>60s</td><td></td></tr><tr><td>GDD_MEM_RECLAIM_TIMEOUT</td><td>Dead node reclamation time in seconds, dead node will be replaced by a new node after this time</td><td>3s</td><td></td></tr><tr><td>GDD_MEM_PROBE_INTERVAL</td><td>Probe interval in seconds</td><td>5s</td><td></td></tr><tr><td>GDD_MEM_PROBE_TIMEOUT</td><td>Probe timeout in seconds</td><td>3s</td><td></td></tr><tr><td>GDD_MEM_SUSPICION_MULT</td><td>Suspicion multiplier, determines the time a node is considered suspicious before being declared dead</td><td>6</td><td></td></tr><tr><td>GDD_MEM_RETRANSMIT_MULT</td><td>Retransmission multiplier</td><td>4</td><td></td></tr><tr><td>GDD_MEM_GOSSIP_NODES</td><td>Number of remote nodes to gossip messages to</td><td>4</td><td></td></tr><tr><td>GDD_MEM_GOSSIP_INTERVAL</td><td>Gossip interval in seconds</td><td>500ms</td><td></td></tr><tr><td>GDD_MEM_TCP_TIMEOUT</td><td>TCP timeout in seconds</td><td>30s</td><td></td></tr><tr><td>GDD_MEM_WEIGHT</td><td>Node weight</td><td>1</td><td></td></tr><tr><td>GDD_MEM_WEIGHT_INTERVAL</td><td>Node weight calculation interval</td><td>0</td><td></td></tr><tr><td>GDD_MEM_INDIRECT_CHECKS</td><td>Number of indirect checks</td><td>3</td><td></td></tr><tr><td>GDD_MEM_LOG_DISABLE</td><td>Disable memberlist logging</td><td>false</td><td></td></tr><tr><td>GDD_MEM_CIDRS_ALLOWED</td><td>CIDRs allowed to connect, allows any connection if not set, must specify IPv6/IPv4 separately</td><td></td><td></td></tr></tbody></table><h2 id="cache-configuration" tabindex="-1"><a class="header-anchor" href="#cache-configuration" aria-hidden="true">#</a> Cache Configuration</h2><table><thead><tr><th>Environment Variable</th><th>Description</th><th>Default Value</th><th>Required</th></tr></thead><tbody><tr><td>GDD_CACHE_TTL</td><td>Cache TTL time in seconds</td><td>0</td><td></td></tr><tr><td>GDD_CACHE_STORES</td><td>Cache storage types, options: <code>redis</code>, <code>ristretto</code>, <code>gocache</code></td><td></td><td></td></tr><tr><td>GDD_CACHE_REDIS_ADDR</td><td>Redis server address</td><td></td><td></td></tr><tr><td>GDD_CACHE_REDIS_USER</td><td>Redis username</td><td></td><td></td></tr><tr><td>GDD_CACHE_REDIS_PASS</td><td>Redis password</td><td></td><td></td></tr><tr><td>GDD_CACHE_REDIS_ROUTEBYLATENCY</td><td>Route Redis requests by latency</td><td>true</td><td></td></tr><tr><td>GDD_CACHE_REDIS_ROUTERANDOMLY</td><td>Route Redis requests randomly</td><td>false</td><td></td></tr><tr><td>GDD_CACHE_RISTRETTO_NUMCOUNTERS</td><td>Ristretto cache counter number</td><td>1000</td><td></td></tr><tr><td>GDD_CACHE_RISTRETTO_MAXCOST</td><td>Ristretto cache maximum cost</td><td>100</td><td></td></tr><tr><td>GDD_CACHE_RISTRETTO_BUFFERITEMS</td><td>Ristretto cache buffer items</td><td>64</td><td></td></tr><tr><td>GDD_CACHE_GOCACHE_EXPIRATION</td><td>GoCache default cache expiration time</td><td>5m</td><td></td></tr><tr><td>GDD_CACHE_GOCACHE_CLEANUP_INTERVAL</td><td>GoCache cleanup interval</td><td>10m</td><td></td></tr></tbody></table><h2 id="gorm-configuration" tabindex="-1"><a class="header-anchor" href="#gorm-configuration" aria-hidden="true">#</a> Gorm Configuration</h2><table><thead><tr><th>Environment Variable</th><th>Description</th><th>Default Value</th><th>Required</th></tr></thead><tbody><tr><td>GDD_DB_DISABLEAUTOCONFIGURE</td><td>Disable auto-configuration</td><td>false</td><td></td></tr><tr><td>GDD_DB_DRIVER</td><td>Database driver name, consistent with gorm: <code>mysql</code>, <code>postgres</code>, <code>sqlite</code>, <code>sqlserver</code>, <code>tidb</code>, <code>clickhouse</code></td><td></td><td></td></tr><tr><td>GDD_DB_DSN</td><td>Database connection address</td><td></td><td></td></tr><tr><td>GDD_DB_TABLE_PREFIX</td><td>Database table prefix</td><td></td><td></td></tr><tr><td>GDD_DB_PREPARESTMT</td><td>Enable prepared statements</td><td>false</td><td></td></tr><tr><td>GDD_DB_SKIPDEFAULTTRANSACTION</td><td>Skip default transaction</td><td>false</td><td></td></tr><tr><td>GDD_DB_POOL_MAXIDLECONNS</td><td>Maximum number of idle connections</td><td>2</td><td></td></tr><tr><td>GDD_DB_POOL_MAXOPENCONNS</td><td>Maximum number of connections, -1 means unlimited</td><td>-1</td><td></td></tr><tr><td>GDD_DB_POOL_CONNMAXLIFETIME</td><td>Maximum time period a connection can be reused, -1 means unlimited</td><td>-1</td><td></td></tr><tr><td>GDD_DB_POOL_CONNMAXIDLETIME</td><td>Maximum idle time for a connection, if it expires it will be closed before reuse, -1 means unlimited</td><td>-1</td><td></td></tr><tr><td>GDD_DB_LOG_SLOWTHRESHOLD</td><td>Slow query log threshold</td><td>200ms</td><td></td></tr><tr><td>GDD_DB_LOG_IGNORERECORDNOTFOUNDERROR</td><td>Ignore record not found error</td><td>false</td><td></td></tr><tr><td>GDD_DB_LOG_PARAMETERIZEDQUERIES</td><td>Hide SQL parameters</td><td>false</td><td></td></tr><tr><td>GDD_DB_LOG_LEVEL</td><td>Log level, consistent with gorm: <code>silent</code>, <code>error</code>, <code>warn</code>, <code>info</code></td><td>warn</td><td></td></tr><tr><td>GDD_DB_MYSQL_SKIPINITIALIZEWITHVERSION</td><td>Gorm&#39;s SkipInitializeWithVersion parameter</td><td>false</td><td></td></tr><tr><td>GDD_DB_MYSQL_DEFAULTSTRINGSIZE</td><td>Gorm&#39;s DefaultStringSize parameter</td><td>0</td><td></td></tr><tr><td>GDD_DB_MYSQL_DISABLEWITHRETURNING</td><td>Gorm&#39;s DisableWithReturning parameter</td><td>false</td><td></td></tr><tr><td>GDD_DB_MYSQL_DISABLEDATETIMEPRECISION</td><td>Gorm&#39;s DisableDatetimePrecision parameter</td><td>false</td><td></td></tr><tr><td>GDD_DB_MYSQL_DONTSUPPORTRENAMEINDEX</td><td>Gorm&#39;s DontSupportRenameIndex parameter</td><td>false</td><td></td></tr><tr><td>GDD_DB_MYSQL_DONTSUPPORTRENAMECOLUMN</td><td>Gorm&#39;s DontSupportRenameColumn parameter</td><td>false</td><td></td></tr><tr><td>GDD_DB_MYSQL_DONTSUPPORTFORSHARECLAUSE</td><td>Gorm&#39;s DontSupportForShareClause parameter</td><td>false</td><td></td></tr><tr><td>GDD_DB_MYSQL_DONTSUPPORTNULLASDEFAULTVALUE</td><td>Gorm&#39;s DontSupportNullAsDefaultValue parameter</td><td>false</td><td></td></tr><tr><td>GDD_DB_MYSQL_DONTSUPPORTRENAMECOLUMNUNIQUE</td><td>Gorm&#39;s DontSupportRenameColumnUnique parameter</td><td>false</td><td></td></tr><tr><td>GDD_DB_POSTGRES_PREFERSIMPLEPROTOCOL</td><td>Gorm&#39;s PreferSimpleProtocol parameter</td><td>false</td><td></td></tr><tr><td>GDD_DB_POSTGRES_WITHOUTRETURNING</td><td>Gorm&#39;s WithoutReturning parameter</td><td>false</td><td></td></tr><tr><td>GDD_DB_PROMETHEUS_ENABLE</td><td>Enable Prometheus monitoring</td><td>false</td><td></td></tr><tr><td>GDD_DB_PROMETHEUS_REFRESHINTERVAL</td><td>Prometheus monitoring refresh interval in seconds</td><td>15</td><td></td></tr><tr><td>GDD_DB_PROMETHEUS_DBNAME</td><td>Database name used for Prometheus monitoring</td><td></td><td></td></tr><tr><td>GDD_DB_CACHE_ENABLE</td><td>Enable database query caching</td><td>false</td><td></td></tr></tbody></table><!--]--></div><footer class="page-meta"><div class="meta-item edit-link"><a class="external-link meta-item-label" href="https://github.com/unionj-cloud/go-doudou/edit/main/guide/configuration.md" rel="noopener noreferrer" target="_blank" aria-label="Edit this page on GitHub"><!--[--><!--]--> Edit this page on GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">Open in new window</span></span><!--[--><!--]--></a></div><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><!----></div><div class="meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: 328454505@qq.com">wubin1989</span><!--[-->, <!--]--><!--]--><!--[--><span class="contributor" title="email: wubinwill@gmail.com">武斌</span><!----><!--]--><!--]--></span></div></footer><nav class="page-nav"><p class="inner"><span class="prev"><a href="/guide/grpc.html" class="" aria-label="gRPC"><!--[--><!--]--> gRPC <!--[--><!--]--></a></span><span class="next"><a href="/guide/deployment.html" class="" aria-label="Deployment"><!--[--><!--]--> Deployment <!--[--><!--]--></a></span></p></nav><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/assets/app.2025f35b.js" defer></script>
  </body>
</html>
