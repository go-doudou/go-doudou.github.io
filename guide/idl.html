<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.35">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <link rel="icon" type="image/x-icon" sizes="32x32" href="/favicon.ico"><script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?658d535852e4dcdd8f3934c1c3e87165";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script><meta name="keywords" content="go-doudou,Go语言微服务框架,golang,go-doudou微服务框架,RESTful,微服务,服务注册与发现,负载均衡,熔断限流,grpc,去中心化,golang microservice framework,golang orm,ORM工具,microservice,service discovery,load balancing,circuit breaker,rate limit,低代码平台"><meta name="description" content="go-doudou是一个go语言微服务框架。它同时支持开发单体应用。从定义Go语言接口开始，无须学习任何接口描述语言。内置基于SWIM gossip协议的服务注册与发现的机制，帮助你构建一个健壮的、可扩展的、去中心化的微服务集群。内置强大的代码生成器。"><title>Define API | go-doudou</title>
    <link rel="modulepreload" href="/assets/app.2025f35b.js"><link rel="modulepreload" href="/assets/idl.html.e0dd6def.js"><link rel="modulepreload" href="/assets/idl.html.47928575.js"><link rel="modulepreload" href="/assets/plugin-vue_export-helper.21dcd24c.js">
    <link rel="stylesheet" href="/assets/style.993d40d8.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header ref_key="navbar" class="navbar"><div class="toggle-sidebar-button" title="Toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/" class=""><img class="logo" src="/logo.png" alt="go-doudou"><span class="site-name can-hide">go-doudou</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><a href="/guide/" class="router-link-active" aria-label="Guide"><!--[--><!--]--> Guide <!--[--><!--]--></a></div><div class="navbar-item"><a href="/resources/" class="" aria-label="Resources"><!--[--><!--]--> Resources <!--[--><!--]--></a></div><div class="navbar-item"><a href="/blog/" class="" aria-label="Blog"><!--[--><!--]--> Blog <!--[--><!--]--></a></div><div class="navbar-item"><a href="/contribution/" class="" aria-label="Contribution"><!--[--><!--]--> Contribution <!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://github.com/unionj-cloud/go-doudou/releases" rel="noopener noreferrer" target="_blank" aria-label="Release Notes"><!--[--><!--]--> Release Notes <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">Open in new window</span></span><!--[--><!--]--></a></div><div class="navbar-item"><a href="/zh/" class="" aria-label="中文"><!--[--><!--]--> 中文 <!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Select language"><span class="title">Languages</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Select language"><span class="title">Languages</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a aria-current="page" href="/guide/idl.html" class="router-link-active router-link-exact-active router-link-active" aria-label="English"><!--[--><!--]--> English <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/zh/guide/idl.html" class="" aria-label="简体中文"><!--[--><!--]--> 简体中文 <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><a class="external-link" href="https://github.com/unionj-cloud/go-doudou" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">Open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-dark-button" title="Toggle dark mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><a href="/guide/" class="router-link-active" aria-label="Guide"><!--[--><!--]--> Guide <!--[--><!--]--></a></div><div class="navbar-item"><a href="/resources/" class="" aria-label="Resources"><!--[--><!--]--> Resources <!--[--><!--]--></a></div><div class="navbar-item"><a href="/blog/" class="" aria-label="Blog"><!--[--><!--]--> Blog <!--[--><!--]--></a></div><div class="navbar-item"><a href="/contribution/" class="" aria-label="Contribution"><!--[--><!--]--> Contribution <!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://github.com/unionj-cloud/go-doudou/releases" rel="noopener noreferrer" target="_blank" aria-label="Release Notes"><!--[--><!--]--> Release Notes <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">Open in new window</span></span><!--[--><!--]--></a></div><div class="navbar-item"><a href="/zh/" class="" aria-label="中文"><!--[--><!--]--> 中文 <!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Select language"><span class="title">Languages</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Select language"><span class="title">Languages</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a aria-current="page" href="/guide/idl.html" class="router-link-active router-link-exact-active router-link-active" aria-label="English"><!--[--><!--]--> English <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/zh/guide/idl.html" class="" aria-label="简体中文"><!--[--><!--]--> 简体中文 <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><a class="external-link" href="https://github.com/unionj-cloud/go-doudou" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">Open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><p tabindex="0" class="sidebar-item sidebar-heading active">Guide <!----></p><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a href="/guide/" class="router-link-active sidebar-item" aria-label="Introduction"><!--[--><!--]--> Introduction <!--[--><!--]--></a><!----></li><li><a href="/guide/getting-started.html" class="sidebar-item" aria-label="Getting Started"><!--[--><!--]--> Getting Started <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/guide/idl.html" class="router-link-active router-link-exact-active router-link-active sidebar-item active" aria-label="Define API"><!--[--><!--]--> Define API <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/guide/idl.html#interface-definition" class="router-link-active router-link-exact-active sidebar-item" aria-label="Interface Definition"><!--[--><!--]--> Interface Definition <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/guide/idl.html#method-signature-rules" class="router-link-active router-link-exact-active sidebar-item" aria-label="Method Signature Rules"><!--[--><!--]--> Method Signature Rules <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/guide/idl.html#basic-method-examples" class="router-link-active router-link-exact-active sidebar-item" aria-label="Basic Method Examples"><!--[--><!--]--> Basic Method Examples <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><a aria-current="page" href="/guide/idl.html#parameter-mapping" class="router-link-active router-link-exact-active sidebar-item" aria-label="Parameter Mapping"><!--[--><!--]--> Parameter Mapping <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/guide/idl.html#for-http-rest" class="router-link-active router-link-exact-active sidebar-item" aria-label="For HTTP (REST)"><!--[--><!--]--> For HTTP (REST) <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/guide/idl.html#for-grpc" class="router-link-active router-link-exact-active sidebar-item" aria-label="For gRPC"><!--[--><!--]--> For gRPC <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><a aria-current="page" href="/guide/idl.html#http-method-mapping" class="router-link-active router-link-exact-active sidebar-item" aria-label="HTTP Method Mapping"><!--[--><!--]--> HTTP Method Mapping <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/guide/idl.html#route-path-generation" class="router-link-active router-link-exact-active sidebar-item" aria-label="Route Path Generation"><!--[--><!--]--> Route Path Generation <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/guide/idl.html#annotations" class="router-link-active router-link-exact-active sidebar-item" aria-label="Annotations"><!--[--><!--]--> Annotations <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/guide/idl.html#rest-annotations" class="router-link-active router-link-exact-active sidebar-item" aria-label="REST Annotations"><!--[--><!--]--> REST Annotations <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/guide/idl.html#grpc-annotations" class="router-link-active router-link-exact-active sidebar-item" aria-label="gRPC Annotations"><!--[--><!--]--> gRPC Annotations <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><a aria-current="page" href="/guide/idl.html#example-complete-service-interface" class="router-link-active router-link-exact-active sidebar-item" aria-label="Example: Complete Service Interface"><!--[--><!--]--> Example: Complete Service Interface <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/guide/idl.html#working-with-view-objects-vo" class="router-link-active router-link-exact-active sidebar-item" aria-label="Working with View Objects (VO)"><!--[--><!--]--> Working with View Objects (VO) <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/guide/idl.html#code-generation" class="router-link-active router-link-exact-active sidebar-item" aria-label="Code Generation"><!--[--><!--]--> Code Generation <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/guide/idl.html#advanced-topics" class="router-link-active router-link-exact-active sidebar-item" aria-label="Advanced Topics"><!--[--><!--]--> Advanced Topics <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/guide/idl.html#pagination" class="router-link-active router-link-exact-active sidebar-item" aria-label="Pagination"><!--[--><!--]--> Pagination <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/guide/idl.html#validation" class="router-link-active router-link-exact-active sidebar-item" aria-label="Validation"><!--[--><!--]--> Validation <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/guide/idl.html#custom-error-handling" class="router-link-active router-link-exact-active sidebar-item" aria-label="Custom Error Handling"><!--[--><!--]--> Custom Error Handling <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><a aria-current="page" href="/guide/idl.html#best-practices" class="router-link-active router-link-exact-active sidebar-item" aria-label="Best Practices"><!--[--><!--]--> Best Practices <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/guide/idl.html#advantages" class="router-link-active router-link-exact-active sidebar-item" aria-label="Advantages"><!--[--><!--]--> Advantages <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/guide/idl.html#disadvantages-or-limitations" class="router-link-active router-link-exact-active sidebar-item" aria-label="Disadvantages or Limitations"><!--[--><!--]--> Disadvantages or Limitations <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/guide/idl.html#enums" class="router-link-active router-link-exact-active sidebar-item" aria-label="Enums"><!--[--><!--]--> Enums <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/guide/idl.html#definition-method" class="router-link-active router-link-exact-active sidebar-item" aria-label="Definition Method"><!--[--><!--]--> Definition Method <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/guide/idl.html#example-code" class="router-link-active router-link-exact-active sidebar-item" aria-label="Example Code"><!--[--><!--]--> Example Code <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><a aria-current="page" href="/guide/idl.html#annotations-1" class="router-link-active router-link-exact-active sidebar-item" aria-label="Annotations"><!--[--><!--]--> Annotations <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/guide/idl.html#definition-method-1" class="router-link-active router-link-exact-active sidebar-item" aria-label="Definition Method"><!--[--><!--]--> Definition Method <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/guide/idl.html#generated-code" class="router-link-active router-link-exact-active sidebar-item" aria-label="Generated Code"><!--[--><!--]--> Generated Code <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/guide/idl.html#usage-in-rest-services" class="router-link-active router-link-exact-active sidebar-item" aria-label="Usage in REST Services"><!--[--><!--]--> Usage in REST Services <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/guide/idl.html#usage-in-grpc-services" class="router-link-active router-link-exact-active sidebar-item" aria-label="Usage in gRPC Services"><!--[--><!--]--> Usage in gRPC Services <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><a aria-current="page" href="/guide/idl.html#grpc" class="router-link-active router-link-exact-active sidebar-item" aria-label="gRPC"><!--[--><!--]--> gRPC <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/guide/idl.html#more-examples" class="router-link-active router-link-exact-active sidebar-item" aria-label="More Examples"><!--[--><!--]--> More Examples <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><a href="/guide/cli.html" class="sidebar-item" aria-label="CLI Commands"><!--[--><!--]--> CLI Commands <!--[--><!--]--></a><!----></li><li><a href="/guide/generation.html" class="sidebar-item" aria-label="Code Generation Rules"><!--[--><!--]--> Code Generation Rules <!--[--><!--]--></a><!----></li><li><a href="/guide/rest.html" class="sidebar-item" aria-label="REST"><!--[--><!--]--> REST <!--[--><!--]--></a><!----></li><li><a href="/guide/grpc.html" class="sidebar-item" aria-label="gRPC"><!--[--><!--]--> gRPC <!--[--><!--]--></a><!----></li><li><a href="/guide/configuration.html" class="sidebar-item" aria-label="Configuration"><!--[--><!--]--> Configuration <!--[--><!--]--></a><!----></li><li><a href="/guide/deployment.html" class="sidebar-item" aria-label="Deployment"><!--[--><!--]--> Deployment <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><h1 id="define-api" tabindex="-1"><a class="header-anchor" href="#define-api" aria-hidden="true">#</a> Define API</h1><p>go-doudou provides an intuitive way to define APIs. Instead of learning interface description languages like OpenAPI or Protobuf, you can simply define Go language interfaces. go-doudou will automatically parse your interface definitions and generate the necessary code for both REST and gRPC services.</p><h2 id="interface-definition" tabindex="-1"><a class="header-anchor" href="#interface-definition" aria-hidden="true">#</a> Interface Definition</h2><p>When you initialize a project with go-doudou, a <code>svc.go</code> file is generated. This file contains a placeholder interface definition like this:</p><div class="language-go ext-go line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#569CD6;">package</span><span style="color:#D4D4D4;"> service</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">import</span><span style="color:#D4D4D4;"> (</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#CE9178;">&quot;context&quot;</span></span>
<span class="line"><span style="color:#D4D4D4;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A9955;">//go:generate go-doudou svc http -c</span></span>
<span class="line"><span style="color:#6A9955;">//go:generate go-doudou svc grpc</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">type</span><span style="color:#D4D4D4;"> </span><span style="color:#4EC9B0;">Helloworld</span><span style="color:#D4D4D4;"> </span><span style="color:#569CD6;">interface</span><span style="color:#D4D4D4;"> {</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#6A9955;">// Define your service methods here</span></span>
<span class="line"><span style="color:#D4D4D4;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>To define your APIs, you add methods to this interface. Each method will be transformed into an HTTP endpoint or a gRPC service method.</p><h2 id="method-signature-rules" tabindex="-1"><a class="header-anchor" href="#method-signature-rules" aria-hidden="true">#</a> Method Signature Rules</h2><p>When defining methods in your service interface, follow these rules:</p><ol><li><strong>First parameter</strong>: Always include a <code>context.Context</code> parameter first</li><li><strong>Input parameters</strong>: Can be of any type, including structs, primitive types, slices, maps, etc.</li><li><strong>Return values</strong>: Must include an <code>error</code> as the last return value, along with optional data return values</li></ol><h3 id="basic-method-examples" tabindex="-1"><a class="header-anchor" href="#basic-method-examples" aria-hidden="true">#</a> Basic Method Examples</h3><div class="language-go ext-go line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#6A9955;">// Simple method with string parameter and string return</span></span>
<span class="line"><span style="color:#569CD6;">func</span><span style="color:#D4D4D4;"> (receiver *HelloworldImpl) </span><span style="color:#DCDCAA;">Greeting</span><span style="color:#D4D4D4;">(ctx context.Context, greeting </span><span style="color:#4EC9B0;">string</span><span style="color:#D4D4D4;">) (data </span><span style="color:#4EC9B0;">string</span><span style="color:#D4D4D4;">, err </span><span style="color:#4EC9B0;">error</span><span style="color:#D4D4D4;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A9955;">// Method with multiple parameters</span></span>
<span class="line"><span style="color:#569CD6;">func</span><span style="color:#D4D4D4;"> (receiver *HelloworldImpl) </span><span style="color:#DCDCAA;">Calculate</span><span style="color:#D4D4D4;">(ctx context.Context, a </span><span style="color:#4EC9B0;">int</span><span style="color:#D4D4D4;">, b </span><span style="color:#4EC9B0;">int</span><span style="color:#D4D4D4;">, op </span><span style="color:#4EC9B0;">string</span><span style="color:#D4D4D4;">) (result </span><span style="color:#4EC9B0;">int</span><span style="color:#D4D4D4;">, err </span><span style="color:#4EC9B0;">error</span><span style="color:#D4D4D4;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A9955;">// Method with struct parameter</span></span>
<span class="line"><span style="color:#569CD6;">func</span><span style="color:#D4D4D4;"> (receiver *HelloworldImpl) </span><span style="color:#DCDCAA;">CreateUser</span><span style="color:#D4D4D4;">(ctx context.Context, user vo.User) (id </span><span style="color:#4EC9B0;">int</span><span style="color:#D4D4D4;">, err </span><span style="color:#4EC9B0;">error</span><span style="color:#D4D4D4;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A9955;">// Method returning a struct</span></span>
<span class="line"><span style="color:#569CD6;">func</span><span style="color:#D4D4D4;"> (receiver *HelloworldImpl) </span><span style="color:#DCDCAA;">GetUserById</span><span style="color:#D4D4D4;">(ctx context.Context, id </span><span style="color:#4EC9B0;">int</span><span style="color:#D4D4D4;">) (user vo.User, err </span><span style="color:#4EC9B0;">error</span><span style="color:#D4D4D4;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A9955;">// Method returning a slice</span></span>
<span class="line"><span style="color:#569CD6;">func</span><span style="color:#D4D4D4;"> (receiver *HelloworldImpl) </span><span style="color:#DCDCAA;">ListUsers</span><span style="color:#D4D4D4;">(ctx context.Context) (users []vo.User, err </span><span style="color:#4EC9B0;">error</span><span style="color:#D4D4D4;">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h2 id="parameter-mapping" tabindex="-1"><a class="header-anchor" href="#parameter-mapping" aria-hidden="true">#</a> Parameter Mapping</h2><p>go-doudou automatically maps your method parameters to HTTP/gRPC parameters based on the following rules:</p><h3 id="for-http-rest" tabindex="-1"><a class="header-anchor" href="#for-http-rest" aria-hidden="true">#</a> For HTTP (REST)</h3><ul><li>Primitive types (string, int, bool, etc.) are mapped to query parameters for GET requests and form fields for POST/PUT requests</li><li>Struct types are mapped to JSON request bodies</li><li>Context is automatically populated with the HTTP request context</li></ul><h3 id="for-grpc" tabindex="-1"><a class="header-anchor" href="#for-grpc" aria-hidden="true">#</a> For gRPC</h3><ul><li>All parameters are mapped to fields in a request message</li><li>The context is passed through the gRPC context mechanism</li></ul><h2 id="http-method-mapping" tabindex="-1"><a class="header-anchor" href="#http-method-mapping" aria-hidden="true">#</a> HTTP Method Mapping</h2><p>go-doudou follows these conventions to determine the HTTP method for each endpoint:</p><ul><li>Methods starting with <code>Get</code> are mapped to GET requests</li><li>Methods starting with <code>List</code> are mapped to GET requests</li><li>Methods starting with <code>Create</code> are mapped to POST requests</li><li>Methods starting with <code>Update</code> are mapped to PUT requests</li><li>Methods starting with <code>Delete</code> are mapped to DELETE requests</li><li>All other methods are mapped to POST requests by default</li></ul><h2 id="route-path-generation" tabindex="-1"><a class="header-anchor" href="#route-path-generation" aria-hidden="true">#</a> Route Path Generation</h2><p>The route path for each endpoint is generated from the method name according to these rules:</p><ul><li>Method names are converted to snake_case</li><li>If the name starts with a verb (Get, List, Create, Update, Delete), the verb is removed before conversion</li><li>For example, <code>GetUserById</code> becomes <code>/user_by_id</code> and <code>CreateUser</code> becomes <code>/user</code></li></ul><p>You can customize the route pattern generation strategy using the <code>-r, --routePattern</code> flag:</p><ul><li><code>0</code> (default): Split the method name by camel case and convert to snake_case</li><li><code>1</code>: Just lowercase the method name without splitting</li></ul><h2 id="annotations" tabindex="-1"><a class="header-anchor" href="#annotations" aria-hidden="true">#</a> Annotations</h2><p>go-doudou supports annotations through Go comments. These annotations provide additional metadata for method handling:</p><h3 id="rest-annotations" tabindex="-1"><a class="header-anchor" href="#rest-annotations" aria-hidden="true">#</a> REST Annotations</h3><div class="language-go ext-go line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#6A9955;">// @handler(formRequest)</span></span>
<span class="line"><span style="color:#6A9955;">// Indicates the method should handle form data instead of JSON</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A9955;">// @handler(streamResponse)</span></span>
<span class="line"><span style="color:#6A9955;">// Indicates the method should stream the response</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A9955;">// @path(/custom/path/:param)</span></span>
<span class="line"><span style="color:#6A9955;">// Sets a custom path for the endpoint</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A9955;">// @middleware(auth)</span></span>
<span class="line"><span style="color:#6A9955;">// Applies a specific middleware to this endpoint only</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="grpc-annotations" tabindex="-1"><a class="header-anchor" href="#grpc-annotations" aria-hidden="true">#</a> gRPC Annotations</h3><div class="language-go ext-go line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#6A9955;">// @grpc</span></span>
<span class="line"><span style="color:#6A9955;">// Marks a method to be exposed as a gRPC service (when using --annotated_only flag)</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="example-complete-service-interface" tabindex="-1"><a class="header-anchor" href="#example-complete-service-interface" aria-hidden="true">#</a> Example: Complete Service Interface</h2><p>Here&#39;s a complete example of a service interface with various method types:</p><div class="language-go ext-go line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#569CD6;">package</span><span style="color:#D4D4D4;"> service</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">import</span><span style="color:#D4D4D4;"> (</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#CE9178;">&quot;context&quot;</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#CE9178;">&quot;github.com/example/myservice/vo&quot;</span></span>
<span class="line"><span style="color:#D4D4D4;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A9955;">//go:generate go-doudou svc http -c</span></span>
<span class="line"><span style="color:#6A9955;">//go:generate go-doudou svc grpc</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">type</span><span style="color:#D4D4D4;"> </span><span style="color:#4EC9B0;">UserService</span><span style="color:#D4D4D4;"> </span><span style="color:#569CD6;">interface</span><span style="color:#D4D4D4;"> {</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#6A9955;">// Get a user by ID</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#6A9955;">// @path(/users/:id)</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#DCDCAA;">GetUserById</span><span style="color:#D4D4D4;">(ctx context.Context, id </span><span style="color:#4EC9B0;">int</span><span style="color:#D4D4D4;">) (user vo.User, err </span><span style="color:#4EC9B0;">error</span><span style="color:#D4D4D4;">)</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#6A9955;">// List users with optional filters</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#DCDCAA;">ListUsers</span><span style="color:#D4D4D4;">(ctx context.Context, page </span><span style="color:#4EC9B0;">int</span><span style="color:#D4D4D4;">, size </span><span style="color:#4EC9B0;">int</span><span style="color:#D4D4D4;">, name </span><span style="color:#4EC9B0;">string</span><span style="color:#D4D4D4;">) (users []vo.User, total </span><span style="color:#4EC9B0;">int</span><span style="color:#D4D4D4;">, err </span><span style="color:#4EC9B0;">error</span><span style="color:#D4D4D4;">)</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#6A9955;">// Create a new user</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#6A9955;">// @middleware(validateUser)</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#DCDCAA;">CreateUser</span><span style="color:#D4D4D4;">(ctx context.Context, user vo.CreateUserRequest) (id </span><span style="color:#4EC9B0;">int</span><span style="color:#D4D4D4;">, err </span><span style="color:#4EC9B0;">error</span><span style="color:#D4D4D4;">)</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#6A9955;">// Update a user</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#6A9955;">// @path(/users/:id)</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#DCDCAA;">UpdateUser</span><span style="color:#D4D4D4;">(ctx context.Context, id </span><span style="color:#4EC9B0;">int</span><span style="color:#D4D4D4;">, user vo.UpdateUserRequest) (success </span><span style="color:#4EC9B0;">bool</span><span style="color:#D4D4D4;">, err </span><span style="color:#4EC9B0;">error</span><span style="color:#D4D4D4;">)</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#6A9955;">// Delete a user</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#6A9955;">// @path(/users/:id)</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#DCDCAA;">DeleteUser</span><span style="color:#D4D4D4;">(ctx context.Context, id </span><span style="color:#4EC9B0;">int</span><span style="color:#D4D4D4;">) (success </span><span style="color:#4EC9B0;">bool</span><span style="color:#D4D4D4;">, err </span><span style="color:#4EC9B0;">error</span><span style="color:#D4D4D4;">)</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#6A9955;">// Upload a user avatar</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#6A9955;">// @handler(formRequest)</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#6A9955;">// @path(/users/:id/avatar)</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#DCDCAA;">UploadAvatar</span><span style="color:#D4D4D4;">(ctx context.Context, id </span><span style="color:#4EC9B0;">int</span><span style="color:#D4D4D4;">, file []</span><span style="color:#4EC9B0;">byte</span><span style="color:#D4D4D4;">) (url </span><span style="color:#4EC9B0;">string</span><span style="color:#D4D4D4;">, err </span><span style="color:#4EC9B0;">error</span><span style="color:#D4D4D4;">)</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#6A9955;">// Download a report</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#6A9955;">// @handler(streamResponse)</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#6A9955;">// @path(/reports/:type)</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#DCDCAA;">DownloadReport</span><span style="color:#D4D4D4;">(ctx context.Context, reportType </span><span style="color:#4EC9B0;">string</span><span style="color:#D4D4D4;">) (data []</span><span style="color:#4EC9B0;">byte</span><span style="color:#D4D4D4;">, err </span><span style="color:#4EC9B0;">error</span><span style="color:#D4D4D4;">)</span></span>
<span class="line"><span style="color:#D4D4D4;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br></div></div><h2 id="working-with-view-objects-vo" tabindex="-1"><a class="header-anchor" href="#working-with-view-objects-vo" aria-hidden="true">#</a> Working with View Objects (VO)</h2><p>The <code>vo</code> package is used to define request and response structures for your API:</p><div class="language-go ext-go line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#569CD6;">package</span><span style="color:#D4D4D4;"> vo</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A9955;">// User represents a user in the system</span></span>
<span class="line"><span style="color:#569CD6;">type</span><span style="color:#D4D4D4;"> </span><span style="color:#4EC9B0;">User</span><span style="color:#D4D4D4;"> </span><span style="color:#569CD6;">struct</span><span style="color:#D4D4D4;"> {</span></span>
<span class="line"><span style="color:#D4D4D4;">	ID        </span><span style="color:#4EC9B0;">int</span><span style="color:#D4D4D4;">       </span><span style="color:#CE9178;">`json:&quot;id&quot;`</span></span>
<span class="line"><span style="color:#D4D4D4;">	Username  </span><span style="color:#4EC9B0;">string</span><span style="color:#D4D4D4;">    </span><span style="color:#CE9178;">`json:&quot;username&quot;`</span></span>
<span class="line"><span style="color:#D4D4D4;">	Email     </span><span style="color:#4EC9B0;">string</span><span style="color:#D4D4D4;">    </span><span style="color:#CE9178;">`json:&quot;email&quot;`</span></span>
<span class="line"><span style="color:#D4D4D4;">	FirstName </span><span style="color:#4EC9B0;">string</span><span style="color:#D4D4D4;">    </span><span style="color:#CE9178;">`json:&quot;firstName,omitempty&quot;`</span></span>
<span class="line"><span style="color:#D4D4D4;">	LastName  </span><span style="color:#4EC9B0;">string</span><span style="color:#D4D4D4;">    </span><span style="color:#CE9178;">`json:&quot;lastName,omitempty&quot;`</span></span>
<span class="line"><span style="color:#D4D4D4;">	CreatedAt time.Time </span><span style="color:#CE9178;">`json:&quot;createdAt&quot;`</span></span>
<span class="line"><span style="color:#D4D4D4;">	UpdatedAt time.Time </span><span style="color:#CE9178;">`json:&quot;updatedAt&quot;`</span></span>
<span class="line"><span style="color:#D4D4D4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A9955;">// CreateUserRequest represents the data needed to create a user</span></span>
<span class="line"><span style="color:#569CD6;">type</span><span style="color:#D4D4D4;"> </span><span style="color:#4EC9B0;">CreateUserRequest</span><span style="color:#D4D4D4;"> </span><span style="color:#569CD6;">struct</span><span style="color:#D4D4D4;"> {</span></span>
<span class="line"><span style="color:#D4D4D4;">	Username  </span><span style="color:#4EC9B0;">string</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">`json:&quot;username&quot; validate:&quot;required,min=3,max=50&quot;`</span></span>
<span class="line"><span style="color:#D4D4D4;">	Email     </span><span style="color:#4EC9B0;">string</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">`json:&quot;email&quot; validate:&quot;required,email&quot;`</span></span>
<span class="line"><span style="color:#D4D4D4;">	Password  </span><span style="color:#4EC9B0;">string</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">`json:&quot;password&quot; validate:&quot;required,min=8&quot;`</span></span>
<span class="line"><span style="color:#D4D4D4;">	FirstName </span><span style="color:#4EC9B0;">string</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">`json:&quot;firstName,omitempty&quot;`</span></span>
<span class="line"><span style="color:#D4D4D4;">	LastName  </span><span style="color:#4EC9B0;">string</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">`json:&quot;lastName,omitempty&quot;`</span></span>
<span class="line"><span style="color:#D4D4D4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A9955;">// UpdateUserRequest represents the data needed to update a user</span></span>
<span class="line"><span style="color:#569CD6;">type</span><span style="color:#D4D4D4;"> </span><span style="color:#4EC9B0;">UpdateUserRequest</span><span style="color:#D4D4D4;"> </span><span style="color:#569CD6;">struct</span><span style="color:#D4D4D4;"> {</span></span>
<span class="line"><span style="color:#D4D4D4;">	Email     </span><span style="color:#4EC9B0;">string</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">`json:&quot;email,omitempty&quot; validate:&quot;omitempty,email&quot;`</span></span>
<span class="line"><span style="color:#D4D4D4;">	FirstName </span><span style="color:#4EC9B0;">string</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">`json:&quot;firstName,omitempty&quot;`</span></span>
<span class="line"><span style="color:#D4D4D4;">	LastName  </span><span style="color:#4EC9B0;">string</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">`json:&quot;lastName,omitempty&quot;`</span></span>
<span class="line"><span style="color:#D4D4D4;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><h2 id="code-generation" tabindex="-1"><a class="header-anchor" href="#code-generation" aria-hidden="true">#</a> Code Generation</h2><p>After defining your service interface, run the following commands to generate the necessary code:</p><div class="language-bash ext-sh line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#6A9955;"># Generate REST API code</span></span>
<span class="line"><span style="color:#D4D4D4;">go-doudou svc http -c</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A9955;"># Generate gRPC service code</span></span>
<span class="line"><span style="color:#D4D4D4;">go-doudou svc grpc</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>This will create:</p><ul><li>HTTP handlers and client code</li><li>OpenAPI 3.0 documentation</li><li>Protocol Buffers definitions</li><li>gRPC server and client stubs</li><li>Service implementation stubs with mock data</li></ul><h2 id="advanced-topics" tabindex="-1"><a class="header-anchor" href="#advanced-topics" aria-hidden="true">#</a> Advanced Topics</h2><h3 id="pagination" tabindex="-1"><a class="header-anchor" href="#pagination" aria-hidden="true">#</a> Pagination</h3><p>For methods that return lists of items, you can implement pagination by including <code>page</code> and <code>size</code> parameters:</p><div class="language-go ext-go line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#6A9955;">// ListUsers returns a paginated list of users</span></span>
<span class="line"><span style="color:#569CD6;">func</span><span style="color:#D4D4D4;"> (receiver *UserServiceImpl) </span><span style="color:#DCDCAA;">ListUsers</span><span style="color:#D4D4D4;">(ctx context.Context, page </span><span style="color:#4EC9B0;">int</span><span style="color:#D4D4D4;">, size </span><span style="color:#4EC9B0;">int</span><span style="color:#D4D4D4;">) (users []vo.User, total </span><span style="color:#4EC9B0;">int</span><span style="color:#D4D4D4;">, err </span><span style="color:#4EC9B0;">error</span><span style="color:#D4D4D4;">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="validation" tabindex="-1"><a class="header-anchor" href="#validation" aria-hidden="true">#</a> Validation</h3><p>go-doudou integrates with validation libraries. You can add validation tags to your struct fields:</p><div class="language-go ext-go line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#569CD6;">type</span><span style="color:#D4D4D4;"> </span><span style="color:#4EC9B0;">CreateUserRequest</span><span style="color:#D4D4D4;"> </span><span style="color:#569CD6;">struct</span><span style="color:#D4D4D4;"> {</span></span>
<span class="line"><span style="color:#D4D4D4;">	Username </span><span style="color:#4EC9B0;">string</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">`json:&quot;username&quot; validate:&quot;required,min=3,max=50&quot;`</span></span>
<span class="line"><span style="color:#D4D4D4;">	Email    </span><span style="color:#4EC9B0;">string</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">`json:&quot;email&quot; validate:&quot;required,email&quot;`</span></span>
<span class="line"><span style="color:#D4D4D4;">	Password </span><span style="color:#4EC9B0;">string</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">`json:&quot;password&quot; validate:&quot;required,min=8&quot;`</span></span>
<span class="line"><span style="color:#D4D4D4;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="custom-error-handling" tabindex="-1"><a class="header-anchor" href="#custom-error-handling" aria-hidden="true">#</a> Custom Error Handling</h3><p>You can define custom error types and use them in your service implementations:</p><div class="language-go ext-go line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#6A9955;">// Define custom error types</span></span>
<span class="line"><span style="color:#569CD6;">var</span><span style="color:#D4D4D4;"> (</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#9CDCFE;">ErrUserNotFound</span><span style="color:#D4D4D4;"> = errors.</span><span style="color:#DCDCAA;">New</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&quot;user not found&quot;</span><span style="color:#D4D4D4;">)</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#9CDCFE;">ErrInvalidInput</span><span style="color:#D4D4D4;"> = errors.</span><span style="color:#DCDCAA;">New</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&quot;invalid input&quot;</span><span style="color:#D4D4D4;">)</span></span>
<span class="line"><span style="color:#D4D4D4;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A9955;">// Use them in implementations</span></span>
<span class="line"><span style="color:#569CD6;">func</span><span style="color:#D4D4D4;"> (receiver *UserServiceImpl) </span><span style="color:#DCDCAA;">GetUserById</span><span style="color:#D4D4D4;">(ctx context.Context, id </span><span style="color:#4EC9B0;">int</span><span style="color:#D4D4D4;">) (user vo.User, err </span><span style="color:#4EC9B0;">error</span><span style="color:#D4D4D4;">) {</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#6A9955;">// Logic to fetch user</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#C586C0;">if</span><span style="color:#D4D4D4;"> userNotFound {</span></span>
<span class="line"><span style="color:#D4D4D4;">		</span><span style="color:#C586C0;">return</span><span style="color:#D4D4D4;"> vo.User{}, ErrUserNotFound</span></span>
<span class="line"><span style="color:#D4D4D4;">	}</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#C586C0;">return</span><span style="color:#D4D4D4;"> user, </span><span style="color:#569CD6;">nil</span></span>
<span class="line"><span style="color:#D4D4D4;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h2 id="best-practices" tabindex="-1"><a class="header-anchor" href="#best-practices" aria-hidden="true">#</a> Best Practices</h2><ol><li><strong>Method Naming</strong>: Use consistent method names that clearly describe the action</li><li><strong>Parameter Types</strong>: Use well-defined struct types for complex parameters instead of many primitive parameters</li><li><strong>Error Handling</strong>: Return meaningful error types that clients can interpret</li><li><strong>Documentation</strong>: Document your interface methods with comments</li><li><strong>Keep It Simple</strong>: Design your API to be intuitive and easy to use</li></ol><p>By following these guidelines and using go-doudou&#39;s API definition approach, you can quickly design and implement clean, consistent APIs for both REST and gRPC services.</p><h1 id="interface-definition-1" tabindex="-1"><a class="header-anchor" href="#interface-definition-1" aria-hidden="true">#</a> Interface Definition</h1><p><code>go-doudou</code> doesn&#39;t reinvent the wheel but adopts Go language interface types as the Interface Description Language (IDL). Users can define methods in Go language interface types, allowing go-doudou to generate corresponding interface code.</p><h2 id="advantages" tabindex="-1"><a class="header-anchor" href="#advantages" aria-hidden="true">#</a> Advantages</h2><ul><li>Easy to learn and use for go-doudou users</li><li>For go-doudou developers, the Go language compiler helps with syntax checking, and IDEs provide syntax highlighting, saving the work of developing IDL and IDE plugins</li></ul><h2 id="disadvantages-or-limitations" tabindex="-1"><a class="header-anchor" href="#disadvantages-or-limitations" aria-hidden="true">#</a> Disadvantages or Limitations</h2><p>Using interface methods as an interface description language has some limitations.</p><ol><li>Only supports generating <code>GET</code>, <code>POST</code>, <code>PUT</code>, <code>DELETE</code> interfaces. The default is a <code>POST</code> interface. You can add the <code>Get</code>/<code>Post</code>/<code>Put</code>/<code>Delete</code> prefix to the method name to specify the http request method of the interface.</li><li>The first parameter in the method signature must be <code>context.Context</code>.</li><li>The parameters and return values in the method signature only support most common Go language <a href="https://golang.org/pkg/builtin/" target="_blank" rel="noopener noreferrer">built-in types<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">Open in new window</span></span></a>, dictionary types with strings as keys, custom struct types in the <code>vo</code> package, and their corresponding slice and pointer types. When generating code and the <code>OpenAPI 3.0</code> interface documentation, go-doudou will only scan structures in the <code>vo</code> package. If a struct type defined outside the <code>vo</code> package appears in the method signature, go-doudou doesn&#39;t know what fields it contains.</li><li>As a special case, you can use the <code>v3.FileModel</code> type as an input parameter to upload files, and the <code>*os.File</code> type as a return value to download files.</li><li>Alias types as struct fields are not supported.</li><li>Function types, channel types, and anonymous struct types as input parameters and return values in method signatures are not supported.</li><li><code>go-doudou</code> treats pointer-type input parameters as optional, while non-pointer type input parameters are required.</li><li>For <code>OpenAPI 3.0</code> interface documentation generation: <ul><li>Request headers, response headers, global parameters, and permission verification are not supported. You can write these contents as Go language comments above the interface declaration or above the interface method signature. These comments will be generated as the value of <code>description</code> in the interface documentation and displayed in the corresponding position on the online interface documentation page.</li><li><a href="https://spec.openapis.org/oas/v3.0.3#tag-object" target="_blank" rel="noopener noreferrer">Tag Object<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">Open in new window</span></span></a>, <a href="https://spec.openapis.org/oas/v3.0.3#callback-object" target="_blank" rel="noopener noreferrer">Callback Object<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">Open in new window</span></span></a>, <a href="https://spec.openapis.org/oas/v3.0.3#discriminator-object" target="_blank" rel="noopener noreferrer">Discriminator Object<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">Open in new window</span></span></a>, <a href="https://spec.openapis.org/oas/v3.0.3#xml-object" target="_blank" rel="noopener noreferrer">XML Object<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">Open in new window</span></span></a>, <a href="https://spec.openapis.org/oas/v3.0.3#security-scheme-object" target="_blank" rel="noopener noreferrer">Security Scheme Object<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">Open in new window</span></span></a>, <a href="https://spec.openapis.org/oas/v3.0.3#oauth-flows-object" target="_blank" rel="noopener noreferrer">OAuth Flows Object<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">Open in new window</span></span></a>, <a href="https://spec.openapis.org/oas/v3.0.3#oauth-flow-object" target="_blank" rel="noopener noreferrer">OAuth Flow Object<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">Open in new window</span></span></a>, <a href="https://spec.openapis.org/oas/v3.0.3#security-requirement-object" target="_blank" rel="noopener noreferrer">Security Requirement Object <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">Open in new window</span></span></a> are not supported. You may not use these APIs, but I need to mention them here.</li></ul></li><li>For Protobuf, <code>oneof</code> is not supported for now.</li><li>When defining stream type input and output parameters, the parameter name must have <code>stream</code> as a prefix, for example: <code>stream1</code>, <code>stream2</code>, <code>streamReq</code>, <code>streamResp</code>, etc.</li></ol><h2 id="enums" tabindex="-1"><a class="header-anchor" href="#enums" aria-hidden="true">#</a> Enums</h2><p>go-doudou has added support for enums since v1.0.5.</p><h3 id="definition-method" tabindex="-1"><a class="header-anchor" href="#definition-method" aria-hidden="true">#</a> Definition Method</h3><ol><li>Define an alias type of a basic type as an enum type in the <code>vo</code> package, and implement the <code>IEnum</code> interface in the <code>github.com/unionj-cloud/go-doudou/v2/toolkit/openapi/v3</code> package</li></ol><div class="language-go ext-go line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#569CD6;">type</span><span style="color:#D4D4D4;"> </span><span style="color:#4EC9B0;">IEnum</span><span style="color:#D4D4D4;"> </span><span style="color:#569CD6;">interface</span><span style="color:#D4D4D4;"> {</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#DCDCAA;">StringSetter</span><span style="color:#D4D4D4;">(value </span><span style="color:#4EC9B0;">string</span><span style="color:#D4D4D4;">)</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#DCDCAA;">StringGetter</span><span style="color:#D4D4D4;">() </span><span style="color:#4EC9B0;">string</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#DCDCAA;">UnmarshalJSON</span><span style="color:#D4D4D4;">(bytes []</span><span style="color:#4EC9B0;">byte</span><span style="color:#D4D4D4;">) </span><span style="color:#4EC9B0;">error</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#DCDCAA;">MarshalJSON</span><span style="color:#D4D4D4;">() ([]</span><span style="color:#4EC9B0;">byte</span><span style="color:#D4D4D4;">, </span><span style="color:#4EC9B0;">error</span><span style="color:#D4D4D4;">)</span></span>
<span class="line"><span style="color:#D4D4D4;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><ol start="2"><li>Define several constants of this enum type</li></ol><h3 id="example-code" tabindex="-1"><a class="header-anchor" href="#example-code" aria-hidden="true">#</a> Example Code</h3><p>For complete demo code, please visit <a href="https://github.com/unionj-cloud/go-doudou-tutorials/tree/master/enumdemo" target="_blank" rel="noopener noreferrer">go-doudou-tutorials/enumdemo<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">Open in new window</span></span></a></p><div class="language-go ext-go line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#569CD6;">package</span><span style="color:#D4D4D4;"> vo</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">import</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">&quot;encoding/json&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A9955;">//go:generate go-doudou name --file $GOFILE -o</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">type</span><span style="color:#D4D4D4;"> </span><span style="color:#4EC9B0;">KeyboardLayout</span><span style="color:#D4D4D4;"> </span><span style="color:#4EC9B0;">int</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">const</span><span style="color:#D4D4D4;"> (</span></span>
<span class="line"><span style="color:#D4D4D4;">	UNKNOWN </span><span style="color:#9CDCFE;">KeyboardLayout</span><span style="color:#D4D4D4;"> = </span><span style="color:#569CD6;">iota</span></span>
<span class="line"><span style="color:#D4D4D4;">	QWERTZ</span></span>
<span class="line"><span style="color:#D4D4D4;">	AZERTY</span></span>
<span class="line"><span style="color:#D4D4D4;">	QWERTY</span></span>
<span class="line"><span style="color:#D4D4D4;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">func</span><span style="color:#D4D4D4;"> (k *KeyboardLayout) </span><span style="color:#DCDCAA;">StringSetter</span><span style="color:#D4D4D4;">(value </span><span style="color:#4EC9B0;">string</span><span style="color:#D4D4D4;">) {</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#C586C0;">switch</span><span style="color:#D4D4D4;"> value {</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#C586C0;">case</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">&quot;UNKNOWN&quot;</span><span style="color:#D4D4D4;">:</span></span>
<span class="line"><span style="color:#D4D4D4;">		*</span><span style="color:#9CDCFE;">k</span><span style="color:#D4D4D4;"> = UNKNOWN</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#C586C0;">case</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">&quot;QWERTY&quot;</span><span style="color:#D4D4D4;">:</span></span>
<span class="line"><span style="color:#D4D4D4;">		*</span><span style="color:#9CDCFE;">k</span><span style="color:#D4D4D4;"> = QWERTY</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#C586C0;">case</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">&quot;QWERTZ&quot;</span><span style="color:#D4D4D4;">:</span></span>
<span class="line"><span style="color:#D4D4D4;">		*</span><span style="color:#9CDCFE;">k</span><span style="color:#D4D4D4;"> = QWERTZ</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#C586C0;">case</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">&quot;AZERTY&quot;</span><span style="color:#D4D4D4;">:</span></span>
<span class="line"><span style="color:#D4D4D4;">		*</span><span style="color:#9CDCFE;">k</span><span style="color:#D4D4D4;"> = AZERTY</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#C586C0;">default</span><span style="color:#D4D4D4;">:</span></span>
<span class="line"><span style="color:#D4D4D4;">		*</span><span style="color:#9CDCFE;">k</span><span style="color:#D4D4D4;"> = UNKNOWN</span></span>
<span class="line"><span style="color:#D4D4D4;">	}</span></span>
<span class="line"><span style="color:#D4D4D4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">func</span><span style="color:#D4D4D4;"> (k *KeyboardLayout) </span><span style="color:#DCDCAA;">StringGetter</span><span style="color:#D4D4D4;">() </span><span style="color:#4EC9B0;">string</span><span style="color:#D4D4D4;"> {</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#C586C0;">switch</span><span style="color:#D4D4D4;"> *k {</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#C586C0;">case</span><span style="color:#D4D4D4;"> UNKNOWN:</span></span>
<span class="line"><span style="color:#D4D4D4;">		</span><span style="color:#C586C0;">return</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">&quot;UNKNOWN&quot;</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#C586C0;">case</span><span style="color:#D4D4D4;"> QWERTY:</span></span>
<span class="line"><span style="color:#D4D4D4;">		</span><span style="color:#C586C0;">return</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">&quot;QWERTY&quot;</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#C586C0;">case</span><span style="color:#D4D4D4;"> QWERTZ:</span></span>
<span class="line"><span style="color:#D4D4D4;">		</span><span style="color:#C586C0;">return</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">&quot;QWERTZ&quot;</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#C586C0;">case</span><span style="color:#D4D4D4;"> AZERTY:</span></span>
<span class="line"><span style="color:#D4D4D4;">		</span><span style="color:#C586C0;">return</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">&quot;AZERTY&quot;</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#C586C0;">default</span><span style="color:#D4D4D4;">:</span></span>
<span class="line"><span style="color:#D4D4D4;">		</span><span style="color:#C586C0;">return</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">&quot;UNKNOWN&quot;</span></span>
<span class="line"><span style="color:#D4D4D4;">	}</span></span>
<span class="line"><span style="color:#D4D4D4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">func</span><span style="color:#D4D4D4;"> (k *KeyboardLayout) </span><span style="color:#DCDCAA;">UnmarshalJSON</span><span style="color:#D4D4D4;">(bytes []</span><span style="color:#4EC9B0;">byte</span><span style="color:#D4D4D4;">) </span><span style="color:#4EC9B0;">error</span><span style="color:#D4D4D4;"> {</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#569CD6;">var</span><span style="color:#D4D4D4;"> </span><span style="color:#9CDCFE;">_k</span><span style="color:#D4D4D4;"> </span><span style="color:#4EC9B0;">string</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#9CDCFE;">err</span><span style="color:#D4D4D4;"> := json.</span><span style="color:#DCDCAA;">Unmarshal</span><span style="color:#D4D4D4;">(bytes, &amp;_k)</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#C586C0;">if</span><span style="color:#D4D4D4;"> err != </span><span style="color:#569CD6;">nil</span><span style="color:#D4D4D4;"> {</span></span>
<span class="line"><span style="color:#D4D4D4;">		</span><span style="color:#C586C0;">return</span><span style="color:#D4D4D4;"> err</span></span>
<span class="line"><span style="color:#D4D4D4;">	}</span></span>
<span class="line"><span style="color:#D4D4D4;">	k.</span><span style="color:#DCDCAA;">StringSetter</span><span style="color:#D4D4D4;">(_k)</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#C586C0;">return</span><span style="color:#D4D4D4;"> </span><span style="color:#569CD6;">nil</span></span>
<span class="line"><span style="color:#D4D4D4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">func</span><span style="color:#D4D4D4;"> (k KeyboardLayout) </span><span style="color:#DCDCAA;">MarshalJSON</span><span style="color:#D4D4D4;">() ([]</span><span style="color:#4EC9B0;">byte</span><span style="color:#D4D4D4;">, </span><span style="color:#4EC9B0;">error</span><span style="color:#D4D4D4;">) {</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#C586C0;">return</span><span style="color:#D4D4D4;"> json.</span><span style="color:#DCDCAA;">Marshal</span><span style="color:#D4D4D4;">(k.</span><span style="color:#DCDCAA;">StringGetter</span><span style="color:#D4D4D4;">())</span></span>
<span class="line"><span style="color:#D4D4D4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">type</span><span style="color:#D4D4D4;"> </span><span style="color:#4EC9B0;">Keyboard</span><span style="color:#D4D4D4;"> </span><span style="color:#569CD6;">struct</span><span style="color:#D4D4D4;"> {</span></span>
<span class="line"><span style="color:#D4D4D4;">	Layout  KeyboardLayout </span><span style="color:#CE9178;">`json:&quot;layout,omitempty&quot;`</span></span>
<span class="line"><span style="color:#D4D4D4;">	Backlit </span><span style="color:#4EC9B0;">bool</span><span style="color:#D4D4D4;">            </span><span style="color:#CE9178;">`json:&quot;backlit,omitempty&quot;`</span></span>
<span class="line"><span style="color:#D4D4D4;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br></div></div><h2 id="annotations-1" tabindex="-1"><a class="header-anchor" href="#annotations-1" aria-hidden="true">#</a> Annotations</h2><p>go-doudou has added support for annotations since v1.1.7.</p><p>Developers can add custom annotations in the Go language documentation comments above the interface methods to add metadata to the interface, making it convenient to read these data when writing custom middleware to implement unified business processing.</p><h3 id="definition-method-1" tabindex="-1"><a class="header-anchor" href="#definition-method-1" aria-hidden="true">#</a> Definition Method</h3><p>Definition format: <code>@AnnotationName(parameter1,parameter2,parameter3...)</code>.</p><p>Definition rules:</p><ol><li>Annotations can be written anywhere in the Go language documentation comments, can have text descriptions before and after, and don&#39;t need spaces</li><li>Annotations must start with the <code>@</code> symbol, and the annotation name cannot contain any white space characters</li><li>The content inside the English parentheses <code>()</code> will be parsed as string slice type parameters, multiple parameters are separated by English commas <code>,</code>, you can define no parameters, but the English parentheses cannot be omitted</li></ol><p>Examples: <code>@role(admin)</code>, <code>@permission(create,update,del)</code>, <code>@inner()</code></p><h3 id="generated-code" tabindex="-1"><a class="header-anchor" href="#generated-code" aria-hidden="true">#</a> Generated Code</h3><p>go-doudou parses the annotations defined by developers and generates a package-level instance <code>RouteAnnotationStore</code> of type <code>github.com/unionj-cloud/go-doudou/v2/framework.AnnotationStore</code> in the <code>transport/httpsrv/handler.go</code> file. Developers can read annotations through <code>httpsrv.RouteAnnotationStore</code> in middleware to implement custom business logic.</p><p>Below is an example of the generated code:</p><div class="language-go ext-go line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#6A9955;">// AnnotationStore type is actually an alias for map[string][]Annotation</span></span>
<span class="line"><span style="color:#6A9955;">// The key is the route name</span></span>
<span class="line"><span style="color:#569CD6;">var</span><span style="color:#D4D4D4;"> </span><span style="color:#9CDCFE;">RouteAnnotationStore</span><span style="color:#D4D4D4;"> = framework.AnnotationStore{</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#CE9178;">&quot;GetUser&quot;</span><span style="color:#D4D4D4;">: {</span></span>
<span class="line"><span style="color:#D4D4D4;">		{</span></span>
<span class="line"><span style="color:#D4D4D4;">			Name: </span><span style="color:#CE9178;">&quot;@role&quot;</span><span style="color:#D4D4D4;">,</span></span>
<span class="line"><span style="color:#D4D4D4;">			Params: []</span><span style="color:#4EC9B0;">string</span><span style="color:#D4D4D4;">{</span></span>
<span class="line"><span style="color:#D4D4D4;">				</span><span style="color:#CE9178;">&quot;USER&quot;</span><span style="color:#D4D4D4;">,</span></span>
<span class="line"><span style="color:#D4D4D4;">				</span><span style="color:#CE9178;">&quot;ADMIN&quot;</span><span style="color:#D4D4D4;">,</span></span>
<span class="line"><span style="color:#D4D4D4;">			},</span></span>
<span class="line"><span style="color:#D4D4D4;">		},</span></span>
<span class="line"><span style="color:#D4D4D4;">	},</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#CE9178;">&quot;GetAdmin&quot;</span><span style="color:#D4D4D4;">: {</span></span>
<span class="line"><span style="color:#D4D4D4;">		{</span></span>
<span class="line"><span style="color:#D4D4D4;">			Name: </span><span style="color:#CE9178;">&quot;@role&quot;</span><span style="color:#D4D4D4;">,</span></span>
<span class="line"><span style="color:#D4D4D4;">			Params: []</span><span style="color:#4EC9B0;">string</span><span style="color:#D4D4D4;">{</span></span>
<span class="line"><span style="color:#D4D4D4;">				</span><span style="color:#CE9178;">&quot;ADMIN&quot;</span><span style="color:#D4D4D4;">,</span></span>
<span class="line"><span style="color:#D4D4D4;">			},</span></span>
<span class="line"><span style="color:#D4D4D4;">		},</span></span>
<span class="line"><span style="color:#D4D4D4;">	},</span></span>
<span class="line"><span style="color:#D4D4D4;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>If you are developing a gRPC service, a package-level instance <code>MethodAnnotationStore</code> of type <code>github.com/unionj-cloud/go-doudou/v2/framework.AnnotationStore</code> will be generated in the <code>transport/grpc/annotation.go</code> file. Developers can read annotations through <code>grpc.MethodAnnotationStore</code> in custom interceptors to implement custom business logic.</p><p>Below is an example of the generated code:</p><div class="language-go ext-go line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#6A9955;">/**</span></span>
<span class="line"><span style="color:#6A9955;">* Generated by go-doudou v2.0.8.</span></span>
<span class="line"><span style="color:#6A9955;">* Don&#39;t edit!</span></span>
<span class="line"><span style="color:#6A9955;"> */</span></span>
<span class="line"><span style="color:#569CD6;">package</span><span style="color:#D4D4D4;"> grpc</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">import</span><span style="color:#D4D4D4;"> (</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#CE9178;">&quot;github.com/unionj-cloud/go-doudou/v2/framework&quot;</span></span>
<span class="line"><span style="color:#D4D4D4;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">var</span><span style="color:#D4D4D4;"> </span><span style="color:#9CDCFE;">MethodAnnotationStore</span><span style="color:#D4D4D4;"> = framework.AnnotationStore{</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#CE9178;">&quot;GetUserRpc&quot;</span><span style="color:#D4D4D4;">: {</span></span>
<span class="line"><span style="color:#D4D4D4;">		{</span></span>
<span class="line"><span style="color:#D4D4D4;">			Name: </span><span style="color:#CE9178;">&quot;@role&quot;</span><span style="color:#D4D4D4;">,</span></span>
<span class="line"><span style="color:#D4D4D4;">			Params: []</span><span style="color:#4EC9B0;">string</span><span style="color:#D4D4D4;">{</span></span>
<span class="line"><span style="color:#D4D4D4;">				</span><span style="color:#CE9178;">&quot;USER&quot;</span><span style="color:#D4D4D4;">,</span></span>
<span class="line"><span style="color:#D4D4D4;">				</span><span style="color:#CE9178;">&quot;ADMIN&quot;</span><span style="color:#D4D4D4;">,</span></span>
<span class="line"><span style="color:#D4D4D4;">			},</span></span>
<span class="line"><span style="color:#D4D4D4;">		},</span></span>
<span class="line"><span style="color:#D4D4D4;">	},</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#CE9178;">&quot;GetAdminRpc&quot;</span><span style="color:#D4D4D4;">: {</span></span>
<span class="line"><span style="color:#D4D4D4;">		{</span></span>
<span class="line"><span style="color:#D4D4D4;">			Name: </span><span style="color:#CE9178;">&quot;@role&quot;</span><span style="color:#D4D4D4;">,</span></span>
<span class="line"><span style="color:#D4D4D4;">			Params: []</span><span style="color:#4EC9B0;">string</span><span style="color:#D4D4D4;">{</span></span>
<span class="line"><span style="color:#D4D4D4;">				</span><span style="color:#CE9178;">&quot;ADMIN&quot;</span><span style="color:#D4D4D4;">,</span></span>
<span class="line"><span style="color:#D4D4D4;">			},</span></span>
<span class="line"><span style="color:#D4D4D4;">		},</span></span>
<span class="line"><span style="color:#D4D4D4;">	},</span></span>
<span class="line"><span style="color:#D4D4D4;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><h3 id="usage-in-rest-services" tabindex="-1"><a class="header-anchor" href="#usage-in-rest-services" aria-hidden="true">#</a> Usage in REST Services</h3><p>Developers can get the route name through the following two lines of code in custom middleware:</p><div class="language-go ext-go line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#9CDCFE;">paramsFromCtx</span><span style="color:#D4D4D4;"> := httprouter.</span><span style="color:#DCDCAA;">ParamsFromContext</span><span style="color:#D4D4D4;">(r.</span><span style="color:#DCDCAA;">Context</span><span style="color:#D4D4D4;">())</span></span>
<span class="line"><span style="color:#9CDCFE;">routeName</span><span style="color:#D4D4D4;"> := paramsFromCtx.</span><span style="color:#DCDCAA;">MatchedRouteName</span><span style="color:#D4D4D4;">()</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>Then call the <code>GetParams</code> method of <code>httpsrv.RouteAnnotationStore</code> to get the annotation information of the current route.</p><p>Below is example code:</p><div class="language-go ext-go line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#569CD6;">func</span><span style="color:#D4D4D4;"> </span><span style="color:#DCDCAA;">Auth</span><span style="color:#D4D4D4;">(client authClient.IAuthClient) </span><span style="color:#569CD6;">func</span><span style="color:#D4D4D4;">(inner http.Handler) http.Handler {</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#C586C0;">return</span><span style="color:#D4D4D4;"> </span><span style="color:#569CD6;">func</span><span style="color:#D4D4D4;">(inner http.Handler) http.Handler {</span></span>
<span class="line"><span style="color:#D4D4D4;">		</span><span style="color:#C586C0;">return</span><span style="color:#D4D4D4;"> http.</span><span style="color:#DCDCAA;">HandlerFunc</span><span style="color:#D4D4D4;">(</span><span style="color:#569CD6;">func</span><span style="color:#D4D4D4;">(w http.ResponseWriter, r *http.Request) {</span></span>
<span class="line"><span style="color:#D4D4D4;">			</span><span style="color:#9CDCFE;">paramsFromCtx</span><span style="color:#D4D4D4;"> := httprouter.</span><span style="color:#DCDCAA;">ParamsFromContext</span><span style="color:#D4D4D4;">(r.</span><span style="color:#DCDCAA;">Context</span><span style="color:#D4D4D4;">())</span></span>
<span class="line"><span style="color:#D4D4D4;">			</span><span style="color:#9CDCFE;">routeName</span><span style="color:#D4D4D4;"> := paramsFromCtx.</span><span style="color:#DCDCAA;">MatchedRouteName</span><span style="color:#D4D4D4;">()</span></span>
<span class="line"><span style="color:#D4D4D4;">			</span><span style="color:#C586C0;">if</span><span style="color:#D4D4D4;"> !httpsrv.RouteAnnotationStore.</span><span style="color:#DCDCAA;">HasAnnotation</span><span style="color:#D4D4D4;">(routeName, </span><span style="color:#CE9178;">&quot;@role&quot;</span><span style="color:#D4D4D4;">) {</span></span>
<span class="line"><span style="color:#D4D4D4;">				inner.</span><span style="color:#DCDCAA;">ServeHTTP</span><span style="color:#D4D4D4;">(w, r)</span></span>
<span class="line"><span style="color:#D4D4D4;">				</span><span style="color:#C586C0;">return</span></span>
<span class="line"><span style="color:#D4D4D4;">			}</span></span>
<span class="line"><span style="color:#D4D4D4;">			</span><span style="color:#9CDCFE;">authHeader</span><span style="color:#D4D4D4;"> := r.Header.</span><span style="color:#DCDCAA;">Get</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&quot;Authorization&quot;</span><span style="color:#D4D4D4;">)</span></span>
<span class="line"><span style="color:#D4D4D4;">			</span><span style="color:#9CDCFE;">baseToken</span><span style="color:#D4D4D4;"> := strings.</span><span style="color:#DCDCAA;">TrimSpace</span><span style="color:#D4D4D4;">(strings.</span><span style="color:#DCDCAA;">TrimPrefix</span><span style="color:#D4D4D4;">(authHeader, </span><span style="color:#CE9178;">&quot;Bearer &quot;</span><span style="color:#D4D4D4;">))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D4D4D4;">			</span><span style="color:#C586C0;">if</span><span style="color:#D4D4D4;"> stringutils.</span><span style="color:#DCDCAA;">IsEmpty</span><span style="color:#D4D4D4;">(baseToken) {</span></span>
<span class="line"><span style="color:#D4D4D4;">				</span><span style="color:#C586C0;">if</span><span style="color:#D4D4D4;"> </span><span style="color:#9CDCFE;">err</span><span style="color:#D4D4D4;"> := r.</span><span style="color:#DCDCAA;">ParseForm</span><span style="color:#D4D4D4;">(); err != </span><span style="color:#569CD6;">nil</span><span style="color:#D4D4D4;"> {</span></span>
<span class="line"><span style="color:#D4D4D4;">					w.</span><span style="color:#DCDCAA;">WriteHeader</span><span style="color:#D4D4D4;">(</span><span style="color:#B5CEA8;">401</span><span style="color:#D4D4D4;">)</span></span>
<span class="line"><span style="color:#D4D4D4;">					w.</span><span style="color:#DCDCAA;">Write</span><span style="color:#D4D4D4;">([]</span><span style="color:#DCDCAA;">byte</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&quot;Unauthorised</span><span style="color:#D7BA7D;">\n</span><span style="color:#CE9178;">&quot;</span><span style="color:#D4D4D4;">))</span></span>
<span class="line"><span style="color:#D4D4D4;">					</span><span style="color:#C586C0;">return</span></span>
<span class="line"><span style="color:#D4D4D4;">				}</span></span>
<span class="line"><span style="color:#D4D4D4;">				</span><span style="color:#9CDCFE;">baseToken</span><span style="color:#D4D4D4;"> = r.</span><span style="color:#DCDCAA;">FormValue</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&quot;t&quot;</span><span style="color:#D4D4D4;">)</span></span>
<span class="line"><span style="color:#D4D4D4;">			}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D4D4D4;">			</span><span style="color:#C586C0;">if</span><span style="color:#D4D4D4;"> stringutils.</span><span style="color:#DCDCAA;">IsEmpty</span><span style="color:#D4D4D4;">(baseToken) {</span></span>
<span class="line"><span style="color:#D4D4D4;">				w.</span><span style="color:#DCDCAA;">WriteHeader</span><span style="color:#D4D4D4;">(</span><span style="color:#B5CEA8;">401</span><span style="color:#D4D4D4;">)</span></span>
<span class="line"><span style="color:#D4D4D4;">				w.</span><span style="color:#DCDCAA;">Write</span><span style="color:#D4D4D4;">([]</span><span style="color:#DCDCAA;">byte</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&quot;Unauthorised</span><span style="color:#D7BA7D;">\n</span><span style="color:#CE9178;">&quot;</span><span style="color:#D4D4D4;">))</span></span>
<span class="line"><span style="color:#D4D4D4;">				</span><span style="color:#C586C0;">return</span></span>
<span class="line"><span style="color:#D4D4D4;">			}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D4D4D4;">			</span><span style="color:#C586C0;">if</span><span style="color:#D4D4D4;"> stringutils.</span><span style="color:#DCDCAA;">IsNotEmpty</span><span style="color:#D4D4D4;">(baseToken) {</span></span>
<span class="line"><span style="color:#D4D4D4;">				</span><span style="color:#569CD6;">var</span><span style="color:#D4D4D4;"> (</span></span>
<span class="line"><span style="color:#D4D4D4;">					</span><span style="color:#9CDCFE;">err</span><span style="color:#D4D4D4;">    </span><span style="color:#4EC9B0;">error</span></span>
<span class="line"><span style="color:#D4D4D4;">					</span><span style="color:#9CDCFE;">userVo</span><span style="color:#D4D4D4;"> vo.UserVo</span></span>
<span class="line"><span style="color:#D4D4D4;">				)</span></span>
<span class="line"><span style="color:#D4D4D4;">				</span><span style="color:#C586C0;">if</span><span style="color:#D4D4D4;"> </span><span style="color:#9CDCFE;">_</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">userVo</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">err</span><span style="color:#D4D4D4;"> = client.</span><span style="color:#DCDCAA;">GetUserByToken</span><span style="color:#D4D4D4;">(r.</span><span style="color:#DCDCAA;">Context</span><span style="color:#D4D4D4;">(), </span><span style="color:#569CD6;">nil</span><span style="color:#D4D4D4;">, baseToken); err != </span><span style="color:#569CD6;">nil</span><span style="color:#D4D4D4;"> {</span></span>
<span class="line"><span style="color:#D4D4D4;">					w.</span><span style="color:#DCDCAA;">WriteHeader</span><span style="color:#D4D4D4;">(</span><span style="color:#B5CEA8;">401</span><span style="color:#D4D4D4;">)</span></span>
<span class="line"><span style="color:#D4D4D4;">					w.</span><span style="color:#DCDCAA;">Write</span><span style="color:#D4D4D4;">([]</span><span style="color:#DCDCAA;">byte</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&quot;Unauthorised</span><span style="color:#D7BA7D;">\n</span><span style="color:#CE9178;">&quot;</span><span style="color:#D4D4D4;">))</span></span>
<span class="line"><span style="color:#D4D4D4;">					</span><span style="color:#C586C0;">return</span></span>
<span class="line"><span style="color:#D4D4D4;">				}</span></span>
<span class="line"><span style="color:#D4D4D4;">				</span><span style="color:#9CDCFE;">role</span><span style="color:#D4D4D4;"> := service.USER</span></span>
<span class="line"><span style="color:#D4D4D4;">				</span><span style="color:#C586C0;">if</span><span style="color:#D4D4D4;"> userVo.SuperAdmin {</span></span>
<span class="line"><span style="color:#D4D4D4;">					</span><span style="color:#9CDCFE;">role</span><span style="color:#D4D4D4;"> = service.SUPER_ADMIN</span></span>
<span class="line"><span style="color:#D4D4D4;">				}</span></span>
<span class="line"><span style="color:#D4D4D4;">				</span><span style="color:#9CDCFE;">params</span><span style="color:#D4D4D4;"> := httpsrv.RouteAnnotationStore.</span><span style="color:#DCDCAA;">GetParams</span><span style="color:#D4D4D4;">(routeName, </span><span style="color:#CE9178;">&quot;@role&quot;</span><span style="color:#D4D4D4;">)</span></span>
<span class="line"><span style="color:#D4D4D4;">				</span><span style="color:#C586C0;">if</span><span style="color:#D4D4D4;"> !sliceutils.</span><span style="color:#DCDCAA;">StringContains</span><span style="color:#D4D4D4;">(params, role.</span><span style="color:#DCDCAA;">StringGetter</span><span style="color:#D4D4D4;">()) {</span></span>
<span class="line"><span style="color:#D4D4D4;">					w.</span><span style="color:#DCDCAA;">WriteHeader</span><span style="color:#D4D4D4;">(</span><span style="color:#B5CEA8;">403</span><span style="color:#D4D4D4;">)</span></span>
<span class="line"><span style="color:#D4D4D4;">					w.</span><span style="color:#DCDCAA;">Write</span><span style="color:#D4D4D4;">([]</span><span style="color:#DCDCAA;">byte</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&quot;Access denied</span><span style="color:#D7BA7D;">\n</span><span style="color:#CE9178;">&quot;</span><span style="color:#D4D4D4;">))</span></span>
<span class="line"><span style="color:#D4D4D4;">					</span><span style="color:#C586C0;">return</span></span>
<span class="line"><span style="color:#D4D4D4;">				}</span></span>
<span class="line"><span style="color:#D4D4D4;">				inner.</span><span style="color:#DCDCAA;">ServeHTTP</span><span style="color:#D4D4D4;">(w, r.</span><span style="color:#DCDCAA;">WithContext</span><span style="color:#D4D4D4;">(service.</span><span style="color:#DCDCAA;">NewLoginUserContext</span><span style="color:#D4D4D4;">(r.</span><span style="color:#DCDCAA;">Context</span><span style="color:#D4D4D4;">(), userVo)))</span></span>
<span class="line"><span style="color:#D4D4D4;">			} </span><span style="color:#C586C0;">else</span><span style="color:#D4D4D4;"> {</span></span>
<span class="line"><span style="color:#D4D4D4;">				inner.</span><span style="color:#DCDCAA;">ServeHTTP</span><span style="color:#D4D4D4;">(w, r)</span></span>
<span class="line"><span style="color:#D4D4D4;">			}</span></span>
<span class="line"><span style="color:#D4D4D4;">		})</span></span>
<span class="line"><span style="color:#D4D4D4;">	}</span></span>
<span class="line"><span style="color:#D4D4D4;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br></div></div><h3 id="usage-in-grpc-services" tabindex="-1"><a class="header-anchor" href="#usage-in-grpc-services" aria-hidden="true">#</a> Usage in gRPC Services</h3><p>First, get the method name through <code>method := fullMethod[strings.LastIndex(fullMethod, &quot;/&quot;)+1:]</code>, then check if the method has the annotation that the interceptor cares about through <code>MethodAnnotationStore.HasAnnotation</code>. If not, let it pass, otherwise continue to execute the business logic. Later, you can get the annotation parameters through <code>MethodAnnotationStore.GetParams</code> to implement custom business logic.</p><div class="language-go ext-go line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#569CD6;">func</span><span style="color:#D4D4D4;"> (interceptor *AuthInterceptor) </span><span style="color:#DCDCAA;">Authorize</span><span style="color:#D4D4D4;">(ctx context.Context, fullMethod </span><span style="color:#4EC9B0;">string</span><span style="color:#D4D4D4;">) (context.Context, </span><span style="color:#4EC9B0;">error</span><span style="color:#D4D4D4;">) {</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#9CDCFE;">method</span><span style="color:#D4D4D4;"> := fullMethod[strings.</span><span style="color:#DCDCAA;">LastIndex</span><span style="color:#D4D4D4;">(fullMethod, </span><span style="color:#CE9178;">&quot;/&quot;</span><span style="color:#D4D4D4;">)+</span><span style="color:#B5CEA8;">1</span><span style="color:#D4D4D4;">:]</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#C586C0;">if</span><span style="color:#D4D4D4;"> !MethodAnnotationStore.</span><span style="color:#DCDCAA;">HasAnnotation</span><span style="color:#D4D4D4;">(method, </span><span style="color:#CE9178;">&quot;@role&quot;</span><span style="color:#D4D4D4;">) {</span></span>
<span class="line"><span style="color:#D4D4D4;">		</span><span style="color:#C586C0;">return</span><span style="color:#D4D4D4;"> ctx, </span><span style="color:#569CD6;">nil</span></span>
<span class="line"><span style="color:#D4D4D4;">	}</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#9CDCFE;">token</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">err</span><span style="color:#D4D4D4;"> := grpc_auth.</span><span style="color:#DCDCAA;">AuthFromMD</span><span style="color:#D4D4D4;">(ctx, </span><span style="color:#CE9178;">&quot;Basic&quot;</span><span style="color:#D4D4D4;">)</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#C586C0;">if</span><span style="color:#D4D4D4;"> err != </span><span style="color:#569CD6;">nil</span><span style="color:#D4D4D4;"> {</span></span>
<span class="line"><span style="color:#D4D4D4;">		</span><span style="color:#C586C0;">return</span><span style="color:#D4D4D4;"> ctx, err</span></span>
<span class="line"><span style="color:#D4D4D4;">	}</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#9CDCFE;">user</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">pass</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">ok</span><span style="color:#D4D4D4;"> := </span><span style="color:#DCDCAA;">parseToken</span><span style="color:#D4D4D4;">(token)</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#C586C0;">if</span><span style="color:#D4D4D4;"> !ok {</span></span>
<span class="line"><span style="color:#D4D4D4;">		</span><span style="color:#C586C0;">return</span><span style="color:#D4D4D4;"> ctx, status.</span><span style="color:#DCDCAA;">Error</span><span style="color:#D4D4D4;">(codes.Unauthenticated, </span><span style="color:#CE9178;">&quot;Provide user name and password&quot;</span><span style="color:#D4D4D4;">)</span></span>
<span class="line"><span style="color:#D4D4D4;">	}</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#9CDCFE;">role</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">exists</span><span style="color:#D4D4D4;"> := interceptor.userStore[vo.Auth{user, pass}]</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#C586C0;">if</span><span style="color:#D4D4D4;"> !exists {</span></span>
<span class="line"><span style="color:#D4D4D4;">		</span><span style="color:#C586C0;">return</span><span style="color:#D4D4D4;"> ctx, status.</span><span style="color:#DCDCAA;">Error</span><span style="color:#D4D4D4;">(codes.Unauthenticated, </span><span style="color:#CE9178;">&quot;Provide user name and password&quot;</span><span style="color:#D4D4D4;">)</span></span>
<span class="line"><span style="color:#D4D4D4;">	}</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#9CDCFE;">params</span><span style="color:#D4D4D4;"> := MethodAnnotationStore.</span><span style="color:#DCDCAA;">GetParams</span><span style="color:#D4D4D4;">(method, </span><span style="color:#CE9178;">&quot;@role&quot;</span><span style="color:#D4D4D4;">)</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#C586C0;">if</span><span style="color:#D4D4D4;"> !sliceutils.</span><span style="color:#DCDCAA;">StringContains</span><span style="color:#D4D4D4;">(params, role.</span><span style="color:#DCDCAA;">StringGetter</span><span style="color:#D4D4D4;">()) {</span></span>
<span class="line"><span style="color:#D4D4D4;">		</span><span style="color:#C586C0;">return</span><span style="color:#D4D4D4;"> ctx, status.</span><span style="color:#DCDCAA;">Error</span><span style="color:#D4D4D4;">(codes.PermissionDenied, </span><span style="color:#CE9178;">&quot;Access denied&quot;</span><span style="color:#D4D4D4;">)</span></span>
<span class="line"><span style="color:#D4D4D4;">	}</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#C586C0;">return</span><span style="color:#D4D4D4;"> ctx, </span><span style="color:#569CD6;">nil</span></span>
<span class="line"><span style="color:#D4D4D4;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><h2 id="grpc" tabindex="-1"><a class="header-anchor" href="#grpc" aria-hidden="true">#</a> gRPC</h2><p>All the rules described above apply to defining gRPC services. Additionally, there are two more points to note:</p><ul><li><code>oneof</code> in <code>Protobuf v3</code> is not supported for now</li><li>When defining stream type input and output parameters, the parameter name must have <code>stream</code> as a prefix, for example: <code>stream1</code>, <code>stream2</code>, <code>streamReq</code>, <code>streamResp</code>, etc.</li></ul><h2 id="more-examples" tabindex="-1"><a class="header-anchor" href="#more-examples" aria-hidden="true">#</a> More Examples</h2><div class="language-go ext-go line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#569CD6;">package</span><span style="color:#D4D4D4;"> service</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">import</span><span style="color:#D4D4D4;"> (</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#CE9178;">&quot;context&quot;</span></span>
<span class="line"><span style="color:#D4D4D4;">	v3 </span><span style="color:#CE9178;">&quot;github.com/unionj-cloud/go-doudou/v2/toolkit/openapi/v3&quot;</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#CE9178;">&quot;os&quot;</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#CE9178;">&quot;usersvc/vo&quot;</span></span>
<span class="line"><span style="color:#D4D4D4;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A9955;">// Usersvc is a user management service</span></span>
<span class="line"><span style="color:#6A9955;">// You need to set the Authentication request header with a bearer token parameter to access protected interfaces, such as user information query interface, user pagination query interface, and avatar upload interface.</span></span>
<span class="line"><span style="color:#6A9955;">// You can add overall service documentation here</span></span>
<span class="line"><span style="color:#569CD6;">type</span><span style="color:#D4D4D4;"> </span><span style="color:#4EC9B0;">Usersvc</span><span style="color:#D4D4D4;"> </span><span style="color:#569CD6;">interface</span><span style="color:#D4D4D4;"> {</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#6A9955;">// PageUsers is a user pagination query interface</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#6A9955;">// Demonstrates how to define a post request with application/json type interface</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#6A9955;">// @role(user)</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#DCDCAA;">PageUsers</span><span style="color:#D4D4D4;">(ctx context.Context,</span></span>
<span class="line"><span style="color:#D4D4D4;">		</span><span style="color:#6A9955;">// pagination parameter</span></span>
<span class="line"><span style="color:#D4D4D4;">		query vo.PageQuery) (</span></span>
<span class="line"><span style="color:#D4D4D4;">		</span><span style="color:#6A9955;">// pagination result</span></span>
<span class="line"><span style="color:#D4D4D4;">		data vo.PageRet,</span></span>
<span class="line"><span style="color:#D4D4D4;">		</span><span style="color:#6A9955;">// error</span></span>
<span class="line"><span style="color:#D4D4D4;">		err </span><span style="color:#4EC9B0;">error</span><span style="color:#D4D4D4;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#6A9955;">// GetUser is a user detail interface</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#6A9955;">// Demonstrates how to define a get request with query string parameters</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#DCDCAA;">GetUser</span><span style="color:#D4D4D4;">(ctx context.Context,</span></span>
<span class="line"><span style="color:#D4D4D4;">		</span><span style="color:#6A9955;">// user id</span></span>
<span class="line"><span style="color:#D4D4D4;">		userId </span><span style="color:#4EC9B0;">int</span><span style="color:#D4D4D4;">) (</span></span>
<span class="line"><span style="color:#D4D4D4;">		</span><span style="color:#6A9955;">// user detail</span></span>
<span class="line"><span style="color:#D4D4D4;">		data vo.UserVo,</span></span>
<span class="line"><span style="color:#D4D4D4;">		</span><span style="color:#6A9955;">// error</span></span>
<span class="line"><span style="color:#D4D4D4;">		err </span><span style="color:#4EC9B0;">error</span><span style="color:#D4D4D4;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#6A9955;">// PublicSignUp is a user registration interface</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#6A9955;">// Demonstrates how to define a post request with application/x-www-form-urlencoded type interface</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#DCDCAA;">PublicSignUp</span><span style="color:#D4D4D4;">(ctx context.Context,</span></span>
<span class="line"><span style="color:#D4D4D4;">		</span><span style="color:#6A9955;">// username</span></span>
<span class="line"><span style="color:#D4D4D4;">		</span><span style="color:#6A9955;">// @validate(gt=0,lte=60)</span></span>
<span class="line"><span style="color:#D4D4D4;">		username </span><span style="color:#4EC9B0;">string</span><span style="color:#D4D4D4;">,</span></span>
<span class="line"><span style="color:#D4D4D4;">		</span><span style="color:#6A9955;">// password</span></span>
<span class="line"><span style="color:#D4D4D4;">		</span><span style="color:#6A9955;">// @validate(gt=0,lte=60)</span></span>
<span class="line"><span style="color:#D4D4D4;">		password </span><span style="color:#4EC9B0;">string</span><span style="color:#D4D4D4;">,</span></span>
<span class="line"><span style="color:#D4D4D4;">		</span><span style="color:#6A9955;">// image code, optional as it is pointer type</span></span>
<span class="line"><span style="color:#D4D4D4;">		code *</span><span style="color:#4EC9B0;">string</span><span style="color:#D4D4D4;">,</span></span>
<span class="line"><span style="color:#D4D4D4;">	) (</span></span>
<span class="line"><span style="color:#D4D4D4;">		</span><span style="color:#6A9955;">// return OK if success</span></span>
<span class="line"><span style="color:#D4D4D4;">		data </span><span style="color:#4EC9B0;">string</span><span style="color:#D4D4D4;">, err </span><span style="color:#4EC9B0;">error</span><span style="color:#D4D4D4;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#6A9955;">// PublicLogIn is a user login interface</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#6A9955;">// Demonstrates how to define a post request with application/x-www-form-urlencoded type interface</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#DCDCAA;">PublicLogIn</span><span style="color:#D4D4D4;">(ctx context.Context,</span></span>
<span class="line"><span style="color:#D4D4D4;">		</span><span style="color:#6A9955;">// username</span></span>
<span class="line"><span style="color:#D4D4D4;">		username </span><span style="color:#4EC9B0;">string</span><span style="color:#D4D4D4;">,</span></span>
<span class="line"><span style="color:#D4D4D4;">		</span><span style="color:#6A9955;">// password</span></span>
<span class="line"><span style="color:#D4D4D4;">		password </span><span style="color:#4EC9B0;">string</span><span style="color:#D4D4D4;">) (</span></span>
<span class="line"><span style="color:#D4D4D4;">		</span><span style="color:#6A9955;">// token</span></span>
<span class="line"><span style="color:#D4D4D4;">		data </span><span style="color:#4EC9B0;">string</span><span style="color:#D4D4D4;">, err </span><span style="color:#4EC9B0;">error</span><span style="color:#D4D4D4;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#6A9955;">// UploadAvatar is an avatar upload interface</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#6A9955;">// Demonstrates how to define a file upload interface</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#6A9955;">// Note: There must be at least one input parameter of type v3.FileModel or []v3.FileModel</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#DCDCAA;">UploadAvatar</span><span style="color:#D4D4D4;">(ctx context.Context,</span></span>
<span class="line"><span style="color:#D4D4D4;">		</span><span style="color:#6A9955;">// user avatar</span></span>
<span class="line"><span style="color:#D4D4D4;">		avatar v3.FileModel, id </span><span style="color:#4EC9B0;">int</span><span style="color:#D4D4D4;">) (</span></span>
<span class="line"><span style="color:#D4D4D4;">		</span><span style="color:#6A9955;">// return OK if success</span></span>
<span class="line"><span style="color:#D4D4D4;">		data </span><span style="color:#4EC9B0;">string</span><span style="color:#D4D4D4;">, err </span><span style="color:#4EC9B0;">error</span><span style="color:#D4D4D4;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#6A9955;">// GetPublicDownloadAvatar is an avatar download interface</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#6A9955;">// Demonstrates how to define a file download interface</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#6A9955;">// Note: There must be exactly one return parameter of type *os.File</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#DCDCAA;">GetPublicDownloadAvatar</span><span style="color:#D4D4D4;">(ctx context.Context,</span></span>
<span class="line"><span style="color:#D4D4D4;">		</span><span style="color:#6A9955;">// user id</span></span>
<span class="line"><span style="color:#D4D4D4;">		userId </span><span style="color:#4EC9B0;">int</span><span style="color:#D4D4D4;">) (</span></span>
<span class="line"><span style="color:#D4D4D4;">		</span><span style="color:#6A9955;">// avatar file</span></span>
<span class="line"><span style="color:#D4D4D4;">		data *os.File, err </span><span style="color:#4EC9B0;">error</span><span style="color:#D4D4D4;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#6A9955;">// BiStream demonstrates how to define a bidirectional streaming RPC</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#DCDCAA;">BiStream</span><span style="color:#D4D4D4;">(ctx context.Context, stream vo.Order) (stream1 vo.Page, err </span><span style="color:#4EC9B0;">error</span><span style="color:#D4D4D4;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#6A9955;">// ClientStream demonstrates how to define a client streaming RPC</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#DCDCAA;">ClientStream</span><span style="color:#D4D4D4;">(ctx context.Context, stream vo.Order) (data vo.Page, err </span><span style="color:#4EC9B0;">error</span><span style="color:#D4D4D4;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#6A9955;">// ServerStream demonstrates how to define a server streaming RPC</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#DCDCAA;">ServerStream</span><span style="color:#D4D4D4;">(ctx context.Context, payload vo.Order) (stream vo.Page, err </span><span style="color:#4EC9B0;">error</span><span style="color:#D4D4D4;">)</span></span>
<span class="line"><span style="color:#D4D4D4;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br></div></div><!--]--></div><footer class="page-meta"><div class="meta-item edit-link"><a class="external-link meta-item-label" href="https://github.com/unionj-cloud/go-doudou/edit/main/guide/idl.md" rel="noopener noreferrer" target="_blank" aria-label="Edit this page on GitHub"><!--[--><!--]--> Edit this page on GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">Open in new window</span></span><!--[--><!--]--></a></div><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><!----></div><div class="meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: 328454505@qq.com">wubin1989</span><!--[-->, <!--]--><!--]--><!--[--><span class="contributor" title="email: wubinwill@gmail.com">武斌</span><!----><!--]--><!--]--></span></div></footer><nav class="page-nav"><p class="inner"><span class="prev"><a href="/guide/getting-started.html" class="" aria-label="Getting Started"><!--[--><!--]--> Getting Started <!--[--><!--]--></a></span><span class="next"><a href="/guide/cli.html" class="" aria-label="CLI Commands"><!--[--><!--]--> CLI Commands <!--[--><!--]--></a></span></p></nav><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/assets/app.2025f35b.js" defer></script>
  </body>
</html>
